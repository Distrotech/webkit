2007-03-17  Adam Roben  <aroben@apple.com>

        Reviewed by Hyatt.

        Implemented console message dumping.

        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/WaitUntilDoneDelegate.cpp:
        (WaitUntilDoneDelegate::QueryInterface): Added cases for IWebUIDelegate[Private]
        (WaitUntilDoneDelegate::webViewAddMessageToConsole): Implemented.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/WaitUntilDoneDelegate.h:
        Now inherits from IWebUIDelegatePrivate

2007-03-15  Adam Roben  <aroben@apple.com>

        Reviewed by Ada.

        Second part of two-step dance to rename AHEM____.TTF to AHEM____.ttf.

        This is to work around <rdar://problem/5063416>.

        Also made all the ttf files in DumpRenderTree/Resources executable again to appease Windows.

        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.cpp:
        (initialize):
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/AHEM____.ttf: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/renameMe.ttf: Removed.

2007-03-15  Adam Roben  <aroben@apple.com>

        Reviewed by Ada.

        First part of a two-step dance to rename AHEM____.TTF to AHEM____.ttf.

        First, rename AHEM____.TTF to renameMe.ttf.

        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.cpp:
        (initialize):
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/AHEM____.TTF: Removed.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/renameMe.ttf: Added.

2007-03-14  Adam Roben  <aroben@apple.com>

        Rubberstamped by Anders.

        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.cpp:
        (runTest): Initialize done to false just like Mac does.

2007-03-14  Adam Roben  <aroben@apple.com>

        Fixed line-endings and svn properties on DRT files.

2007-03-14  Adam Roben  <aroben@apple.com>

        Reviewed by Anders.

        Make DRT on Windows behave more like DRT on Mac with respect to
        waitUntilDone()/waitUntilDone().

        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.cpp:
        Added "done" and "topLoadingFrame" globals to match Mac, removed readyToDump.
        (dump): Set done to true.
        (runTest): Removed readyToDump, initialized topLoadingFrame.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.h:
        Added extern declarations for globals.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/LayoutTestController.cpp:
        (notifyDoneCallback): Changed condition to match Mac.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/WaitUntilDoneDelegate.cpp:
        (WaitUntilDoneDelegate::didStartProvisionalLoadForFrame): Set topLoadingFrame.
        (WaitUntilDoneDelegate::locationChangeDone): Ported from Mac.
        (WaitUntilDoneDelegate::didFinishLoadForFrame): Call locationChangeDone.
        (WaitUntilDoneDelegate::didFailLoadWithError): Ditto.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/WaitUntilDoneDelegate.h:
        Moved implementation of didFailLoadWithError to .cpp file.

2007-03-14  Adam Roben  <aroben@apple.com>

        Reviewed by Anders.

        Use Mac fonts when running regression tests to match Mac's metrics.

        This makes many layout tests pass when run against results generated on the Mac.

        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.cpp:
        Turned on Mac fonts.
        (initialize): Install our Mac fonts into GDI programmatically at runtime.
        (dump): Match Mac's handling of newlines when printing.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.h:
        Added WINVER define to get access to AddFontResourceEx.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.vcproj:
        Added post-build step to copy fonts to WebKitOutputDir/DumpRenderThree.resources.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/WaitUntilDoneDelegate.cpp:
        * Re-ordered #includes.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/WaitUntilDoneDelegate.h:
        Moved #includes within header guard.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/AHEM____.TTF: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/Apple Chancery.ttf: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/Arial Bold.ttf: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/Arial Bold Italic.ttf: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/Arial Italic.ttf: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/Arial.ttf: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/Courier Bold.ttf: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/Courier.ttf: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/Helvetica Bold.ttf: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/Helvetica.ttf: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/Lucida Grande Bold.ttf: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/Lucida Grande.ttf: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/Monaco.ttf: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/Papyrus.ttf: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/Times Bold Italic.ttf: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/Times Bold.ttf: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/Times Italic.ttf: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/Resources/Times Roman.ttf: Added.

2007-03-12  Adam Roben  <aroben@apple.com>

        Reviewed by Darin.

        Get DRT to size the WebView correctly, and added font family prefs.

        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.cpp:
        (initialize): Make the DRT window an off-screen tool window so it isn't
        visible to the user despite having been "shown".
        (initializePreferences): Set font preferences.
        (main): Initially size the WebView to 0x0, then do a SetWindowPos to
        the desired size (this is what Boomer does).

2007-03-09  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Adam.

        Fix build and do some general cleanup.
        
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/WaitUntilDoneDelegate.h:
        (WaitUntilDoneDelegate::didReceiveServerRedirectForProvisionalLoadForFrame):
        (WaitUntilDoneDelegate::didFailProvisionalLoadWithError):
        (WaitUntilDoneDelegate::didCommitLoadForFrame):
        (WaitUntilDoneDelegate::didReceiveIcon):
        (WaitUntilDoneDelegate::didFailLoadWithError):
        (WaitUntilDoneDelegate::didChangeLocationWithinPageForFrame):
        (WaitUntilDoneDelegate::willPerformClientRedirectToURL):
        (WaitUntilDoneDelegate::didCancelClientRedirectForFrame):
        (WaitUntilDoneDelegate::willCloseFrame):
        (WaitUntilDoneDelegate::createWebViewWithRequest):
        (WaitUntilDoneDelegate::webViewShow):
        (WaitUntilDoneDelegate::webViewClose):
        (WaitUntilDoneDelegate::webViewFocus):
        (WaitUntilDoneDelegate::webViewUnfocus):
        (WaitUntilDoneDelegate::webViewFirstResponder):
        (WaitUntilDoneDelegate::makeFirstResponder):
        (WaitUntilDoneDelegate::setStatusText):
        (WaitUntilDoneDelegate::webViewStatusText):
        (WaitUntilDoneDelegate::webViewAreToolbarsVisible):
        (WaitUntilDoneDelegate::setToolbarsVisible):
        (WaitUntilDoneDelegate::webViewIsStatusBarVisible):
        (WaitUntilDoneDelegate::setStatusBarVisible):
        (WaitUntilDoneDelegate::webViewIsResizable):
        (WaitUntilDoneDelegate::setResizable):
        (WaitUntilDoneDelegate::setFrame):
        (WaitUntilDoneDelegate::webViewFrame):
        (WaitUntilDoneDelegate::setContentRect):
        (WaitUntilDoneDelegate::webViewContentRect):
        (WaitUntilDoneDelegate::runJavaScriptConfirmPanelWithMessage):
        (WaitUntilDoneDelegate::runJavaScriptTextInputPanelWithPrompt):
        (WaitUntilDoneDelegate::runBeforeUnloadConfirmPanelWithMessage):
        (WaitUntilDoneDelegate::runOpenPanelForFileButtonWithResultListener):
        (WaitUntilDoneDelegate::mouseDidMoveOverElement):
        (WaitUntilDoneDelegate::contextMenuItemsForElement):
        (WaitUntilDoneDelegate::validateUserInterfaceItem):
        (WaitUntilDoneDelegate::shouldPerformAction):
        (WaitUntilDoneDelegate::dragDestinationActionMaskForDraggingInfo):
        (WaitUntilDoneDelegate::willPerformDragDestinationAction):
        (WaitUntilDoneDelegate::dragSourceActionMaskForPoint):
        (WaitUntilDoneDelegate::willPerformDragSourceAction):
        (WaitUntilDoneDelegate::contextMenuItemSelected):
        (WaitUntilDoneDelegate::trackCustomPopupMenu):
        (WaitUntilDoneDelegate::measureCustomMenuItem):
        (WaitUntilDoneDelegate::drawCustomMenuItem):
        (WaitUntilDoneDelegate::cleanUpCustomMenuDrawingData):
        (WaitUntilDoneDelegate::canTakeFocus):
        (WaitUntilDoneDelegate::takeFocus):
        (WaitUntilDoneDelegate::registerUndoWithTarget):
        (WaitUntilDoneDelegate::removeAllActionsWithTarget):
        (WaitUntilDoneDelegate::setActionTitle):
        (WaitUntilDoneDelegate::undo):
        (WaitUntilDoneDelegate::redo):
        (WaitUntilDoneDelegate::canUndo):
        (WaitUntilDoneDelegate::canRedo):
        (WaitUntilDoneDelegate::addCustomMenuDrawingData):

2007-01-29  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Darin and Geoff.

        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.cpp:
        (initialize):
        Call OleInitialize.
        
        (runTest):
        Use CF for creating the URLs passed in.
        
        (initializePreferences):
        Don't autosave the preferences.
        
        (main):
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.vcproj:
        Link with CF.

2007-01-29  Anders Carlsson  <acarlsson@apple.com>

        Build fix.
        
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/WaitUntilDoneDelegate.h:
        (WaitUntilDoneDelegate::dragDestinationActionMaskForDraggingInfo):
        (WaitUntilDoneDelegate::willPerformDragDestinationAction):

2007-01-18  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Adam.

        Major cleanups and bugfixes, such as:
        
        Update for changes to the API.
        Implement a timer which prevents test from hanging indefinitely.
        Fix bugs which would cause the same test result to be dumped twice.
        
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.cpp:
        (DumpRenderTreeWndProc):
        Handle timer.
        
        (initialize):
        Initialize CoreGraphics so we get fonts.
        (runTest):
        Add timer.
        
        (initializePreferences):
        Turn off Java and Plug-ins.
        
        (main):
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.h:
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.vcproj:
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/LayoutTestController.cpp:
        (waitUntilDoneCallback):
        (notifyDoneCallback):
        Fix bug where dump could be called twice.
        
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/WaitUntilDoneDelegate.cpp:
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/WaitUntilDoneDelegate.h:
        Fix newlines, update for new API.

2006-11-07  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Geoff.
        
        Fix the build. Hook up a layoutTestController and implement dumpAsText, waitUntilDone and notifyDone.

        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.cpp:
        (dump):
        (main):
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.h: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.vcproj:
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/LayoutTestController.cpp: Added.
        (dumpAsTextCallback):
        (waitUntilDoneCallback):
        (notifyDoneCallback):
        (getClass):
        (createLayoutTestController):
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/LayoutTestController.h: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/WaitUntilDoneDelegate.cpp:
        (WaitUntilDoneDelegate::didFinishLoadForFrame):
        (WaitUntilDoneDelegate::windowScriptObjectAvailable):
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/WaitUntilDoneDelegate.h:
        (WaitUntilDoneDelegate::didReceiveServerRedirectForProvisionalLoadForFrame):
        (WaitUntilDoneDelegate::didFailProvisionalLoadWithError):
        (WaitUntilDoneDelegate::didCommitLoadForFrame):
        (WaitUntilDoneDelegate::didReceiveIcon):
        (WaitUntilDoneDelegate::didFailLoadWithError):
        (WaitUntilDoneDelegate::didChangeLocationWithinPageForFrame):
        (WaitUntilDoneDelegate::willPerformClientRedirectToURL):
        (WaitUntilDoneDelegate::didCancelClientRedirectForFrame):
        (WaitUntilDoneDelegate::willCloseFrame):
        (WaitUntilDoneDelegate::createWebViewWithRequest):
        (WaitUntilDoneDelegate::webViewShow):
        (WaitUntilDoneDelegate::webViewClose):
        (WaitUntilDoneDelegate::webViewFocus):
        (WaitUntilDoneDelegate::webViewUnfocus):
        (WaitUntilDoneDelegate::webViewFirstResponder):
        (WaitUntilDoneDelegate::makeFirstResponder):
        (WaitUntilDoneDelegate::setStatusText):
        (WaitUntilDoneDelegate::webViewStatusText):
        (WaitUntilDoneDelegate::webViewAreToolbarsVisible):
        (WaitUntilDoneDelegate::setToolbarsVisible):
        (WaitUntilDoneDelegate::webViewIsStatusBarVisible):
        (WaitUntilDoneDelegate::setStatusBarVisible):
        (WaitUntilDoneDelegate::webViewIsResizable):
        (WaitUntilDoneDelegate::setResizable):
        (WaitUntilDoneDelegate::setFrame):
        (WaitUntilDoneDelegate::webViewFrame):
        (WaitUntilDoneDelegate::setContentRect):
        (WaitUntilDoneDelegate::webViewContentRect):
        (WaitUntilDoneDelegate::runJavaScriptConfirmPanelWithMessage):
        (WaitUntilDoneDelegate::runJavaScriptTextInputPanelWithPrompt):
        (WaitUntilDoneDelegate::runOpenPanelForFileButtonWithResultListener):
        (WaitUntilDoneDelegate::mouseDidMoveOverElement):
        (WaitUntilDoneDelegate::contextMenuItemsForElement):
        (WaitUntilDoneDelegate::validateUserInterfaceItem):
        (WaitUntilDoneDelegate::shouldPerformAction):
        (WaitUntilDoneDelegate::dragDestinationActionMaskForDraggingInfo):
        (WaitUntilDoneDelegate::willPerformDragDestinationAction):
        (WaitUntilDoneDelegate::dragSourceActionMaskForPoint):
        (WaitUntilDoneDelegate::willPerformDragSourceAction):

2006-10-06  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Maciej.

        Land new version of DumpRenderTree that uses the WebKit APIs.
        
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.cpp:
        (initialize):
        (dump):
        (runTest):
        (main):
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/DumpRenderTree.vcproj:
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/WaitUntilDoneDelegate.cpp: Added.
        (WaitUntilDoneDelegate::QueryInterface):
        (WaitUntilDoneDelegate::AddRef):
        (WaitUntilDoneDelegate::Release):
        (WaitUntilDoneDelegate::didStartProvisionalLoadForFrame):
        (WaitUntilDoneDelegate::didReceiveTitle):
        (WaitUntilDoneDelegate::didFinishLoadForFrame):
        (WaitUntilDoneDelegate::runJavaScriptAlertPanelWithMessage):
        (WaitUntilDoneDelegate::windowScriptObjectAvailable):
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/WaitUntilDoneDelegate.h: Added.
        (WaitUntilDoneDelegate::WaitUntilDoneDelegate):
        (WaitUntilDoneDelegate::didReceiveServerRedirectForProvisionalLoadForFrame):
        (WaitUntilDoneDelegate::didFailProvisionalLoadWithError):
        (WaitUntilDoneDelegate::didCommitLoadForFrame):
        (WaitUntilDoneDelegate::didReceiveIcon):
        (WaitUntilDoneDelegate::didFailLoadWithError):
        (WaitUntilDoneDelegate::didChangeLocationWithinPageForFrame):
        (WaitUntilDoneDelegate::willPerformClientRedirectToURL):
        (WaitUntilDoneDelegate::didCancelClientRedirectForFrame):
        (WaitUntilDoneDelegate::willCloseFrame):
        (WaitUntilDoneDelegate::createWebViewWithRequest):
        (WaitUntilDoneDelegate::webViewShow):
        (WaitUntilDoneDelegate::webViewClose):
        (WaitUntilDoneDelegate::webViewFocus):
        (WaitUntilDoneDelegate::webViewUnfocus):
        (WaitUntilDoneDelegate::webViewFirstResponder):
        (WaitUntilDoneDelegate::makeFirstResponder):
        (WaitUntilDoneDelegate::setStatusText):
        (WaitUntilDoneDelegate::webViewStatusText):
        (WaitUntilDoneDelegate::webViewAreToolbarsVisible):
        (WaitUntilDoneDelegate::setToolbarsVisible):
        (WaitUntilDoneDelegate::webViewIsStatusBarVisible):
        (WaitUntilDoneDelegate::setStatusBarVisible):
        (WaitUntilDoneDelegate::webViewIsResizable):
        (WaitUntilDoneDelegate::setResizable):
        (WaitUntilDoneDelegate::setFrame):
        (WaitUntilDoneDelegate::webViewFrame):
        (WaitUntilDoneDelegate::setContentRect):
        (WaitUntilDoneDelegate::webViewContentRect):
        (WaitUntilDoneDelegate::runJavaScriptConfirmPanelWithMessage):
        (WaitUntilDoneDelegate::runJavaScriptTextInputPanelWithPrompt):
        (WaitUntilDoneDelegate::runOpenPanelForFileButtonWithResultListener):
        (WaitUntilDoneDelegate::mouseDidMoveOverElement):
        (WaitUntilDoneDelegate::contextMenuItemsForElement):
        (WaitUntilDoneDelegate::validateUserInterfaceItem):
        (WaitUntilDoneDelegate::shouldPerformAction):
        (WaitUntilDoneDelegate::dragDestinationActionMaskForDraggingInfo):
        (WaitUntilDoneDelegate::willPerformDragDestinationAction):
        (WaitUntilDoneDelegate::dragSourceActionMaskForPoint):
        (WaitUntilDoneDelegate::willPerformDragSourceAction):
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/debug.vsprops: Added.
        * DumpRenderTree/DumpRenderTree.vcproj/DumpRenderTree/release.vsprops: Added.

