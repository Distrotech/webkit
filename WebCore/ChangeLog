2006-11-03  Maciej Stachowiak  <mjs@apple.com>

        Reviewed by Adele.

        - replaced receivedRedirect with new willSendRequest delegate
        - removed most mac-specific loader functions
        - use ResourceResponse more in loader code

        * WebCore.vcproj/WebCore.vcproj: Added new files
        * platform/win/TemporaryLinkStubs.cpp: Removed unneeded link stubs

2006-11-03  Steve Falkenburg  <sfalken@apple.com>

        Fix build

        * config.h: Touched to cause re-build w/ SVG_SUPPORT enabled
        * platform/win/TemporaryLinkStubs.cpp:
        (WebCore::CachedResource::setResponse): Added

2006-11-03  Steve Falkenburg  <sfalken@apple.com>

        Fix build

        * platform/win/TemporaryLinkStubs.cpp:
        (WebCore::CachedResource::setResponse):

2006-11-03  Adele Peterson  <adele@apple.com>

        Reviewed by Oliver.

        Removed DeprecatedRenderSelect and ListBox classes.

        * WebCore.vcproj/WebCore.vcproj:
        * platform/win/TemporaryLinkStubs.cpp:

2006-11-03  Anders Carlsson  <acarlsson@apple.com>

        Remove SVGRenderAsText files from the project.
        
        * WebCore.vcproj/WebCore.vcproj:

2006-11-03  Anders Carlsson  <acarlsson@apple.com>

        Build fix.
        
        * platform/win/TemporaryLinkStubs.cpp:
        (WebCore::CachedResource::setPlatformResponse):

2006-11-03  Geoffrey Garen  <ggaren@apple.com>

        Reviewed by Darin, Beth.

        Updated to use ChromeClient.
        
        * WebCore.vcproj/WebCore.vcproj:
        * bridge/win/PageWin.cpp:
        * loader/win/ResourceLoaderWin.cpp: Added.
        (WebCore::ResourceLoader::loadsBlocked):
        * platform/win/TemporaryLinkStubs.cpp:

2006-11-02  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Oliver.

        * WebCore.vcproj/WebCore.vcproj:
        Use the forked CursorWin.cpp
        
        * platform/win/CursorWin.cpp:
        (WebCore::moveCursor):
        Implement this.
        
        * platform/win/TemporaryLinkStubs.cpp:
        Get rid of it here.
        
2006-11-02  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Oliver.

        Add forked copy of CursorWin.cpp
        
        * platform/win/CursorWin.cpp: Added.

2006-11-01  Oliver Hunt  <oliver@apple.com>

        Reviewed by Adam.

        Adding SVG_SUPPORT to Boomer.

        * WebCore.vcproj/WebCore.vcproj:
        * WebCore.vcproj/build-generated-files.sh:
        * kcanvas/device/quartz/KCanvasFilterQuartz.cpp: Added.
        (WebCore::KCanvasFilterQuartz::KCanvasFilterQuartz):
        (WebCore::KCanvasFilterQuartz::~KCanvasFilterQuartz):
        (WebCore::KCanvasFilterQuartz::prepareFilter):
        (WebCore::KCanvasFilterQuartz::applyFilter):
        (WebCore::KCanvasFilterQuartz::imageForName):
        (WebCore::KCanvasFilterQuartz::setImageForName):
        (WebCore::KCanvasFilterQuartz::setOutputImage):
        (WebCore::KCanvasFilterQuartz::inputImage):
        * platform/graphics/svg/cg/SVGResourceMaskerCg.cpp: Added.
        (WebCore::SVGResourceMasker::applyMask):

2006-11-01  Beth Dakin  <bdakin@apple.com>

        Reviewed by Adam.

        Build fix from Sam Weinig's check-in. i.p in the PaintInfo is now 
        i.context

        * rendering/RenderThemeWin.cpp:
        (WebCore::RenderThemeWin::paintButton):
        (WebCore::RenderThemeWin::paintTextField):
        (WebCore::RenderThemeWin::paintMenuList):
        (WebCore::RenderThemeWin::paintMenuListButton):

2006-11-01  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Geoff.

        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::createJavaAppletWidget):
        Ask the plugin database to create a java applet plugin.

        * platform/win/TemporaryLinkStubs.cpp:
        Remove FrameWin::createJavaAppletWidget.
        
        * plugins/win/PluginDatabaseWin.cpp:
        (WebCore::PluginDatabaseWin::defaultPluginPaths):
        Don't look for the Sun Java plugin anymore.

2006-11-01  Anders Carlsson  <acarlsson@apple.com>

        * plugins/win/PluginStreamWin.cpp:
        (WebCore::PluginStreamWin::startStream):
        Build fix.
        
2006-11-01  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Adam.

        Convert plugin code over to using ResourceResponse.
        
        * plugins/win/PluginStreamWin.cpp:
        (WebCore::PluginStreamWin::startStream):
        (WebCore::PluginStreamWin::didReceiveResponse):
        (WebCore::PluginStreamWin::didFinishLoading):
        * plugins/win/PluginStreamWin.h:
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::performRequest):

2006-10-31  Steve Falkenburg  <sfalken@apple.com>

        Yet more B&I build fixes
        Another missing .h file from the vcproj

        * WebCore.vcproj/WebCore.vcproj:

2006-10-31  Steve Falkenburg  <sfalken@apple.com>

        Another fix for B&I submission
        (missing .h files from the WebCore vcproj prevents proper merging of OpenSource/Internal WebCore trees)

        * WebCore.vcproj/WebCore.vcproj:

2006-10-31  Steve Falkenburg  <sfalken@apple.com>

        Remove extra files I accidently added

        * WebCore.vcproj/WebCore.vcproj:

2006-10-31  Steve Falkenburg  <sfalken@apple.com>

        Build fixes for submission merge script

        * WebCore.vcproj/WebCore.vcproj:

2006-10-31  Adam Roben  <aroben@apple.com>

        Build fixes.

        * WebCore.vcproj/WebCore.vcproj: Add new platform/graphics directory to
        our include path, and copy headers from there for WebKit's benefit.
        * bridge/win/FrameWin.cpp: Update accessors of FrameLoadRequest.
        (WebCore::FrameWin::urlSelected):
        (WebCore::FrameWin::submitForm):
        * plugins/win/PluginViewWin.cpp: Ditto.
        (WebCore::PluginViewWin::start):
        (WebCore::PluginViewWin::performRequest):
        (WebCore::PluginViewWin::load):
        (WebCore::PluginViewWin::getURLNotify):
        (WebCore::PluginViewWin::getURL):
        (WebCore::PluginViewWin::handlePost):
        * plugins/win/PluginViewWin.h: Correct forward declaration of
        FrameLoadRequest.

2006-10-30  Darin Adler  <darin@apple.com>

        Reviewed by Anders.

        - remove BrowserExtension

        * WebCore.vcproj/WebCore.vcproj:
        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::FrameWin):
        * platform/win/TemporaryLinkStubs.cpp:
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::performRequest):

2006-10-30  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Adam.

        If there's no plug-in for a given mime type, or if the plug-in fails
        to initialize, draw the "missing plug-in" icon.

        * plugins/win/PluginDatabaseWin.cpp:
        (WebCore::PluginDatabaseWin::createPluginView):
        If no plug-in can be found, create a null plugin view.
        
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::paint):
        If the plugin hasn't been started, paint the missing plugin image.
        
        (WebCore::PluginViewWin::setNPWindowSize):
        Return early if the plugin hasn't been started.
        
        (WebCore::PluginViewWin::start):
        Return if the plugin couldn't be created.
        
        (WebCore::PluginViewWin::createNullPluginView):
        New function which just creates a plugin view and doesn't try to start its plugin
        (because there is none).
        
        (WebCore::PluginViewWin::PluginViewWin):
        New constructor for the null plugin view.
        
2006-10-31  Darin Adler  <darin@apple.com>

        Reviewed by Adam.

        * WebCore.vcproj/WebCore.vcproj: Added new source files from the
        loader directory.

2006-10-29  Maciej Stachowiak  <mjs@apple.com>

        Reviewed by Anders.

        - added ResourceResponse class and didReceiveResponse delegate call

        * WebCore.vcproj/WebCore.vcproj: Added new files.
        * platform/win/TemporaryLinkStubs.cpp:
        (WebCore::ServeSynchronousRequest): Changed prototype to match
        new version.

2006-10-29  Darin Adler  <darin@apple.com>

        - update for the WebCore renames

        * WebCore.vcproj/WebCore.vcproj:
        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::bindingRootObject):
        (WebCore::FrameWin::windowScriptNPObject):
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::load):
        (WebCore::PluginViewWin::bindingInstance):

2006-10-29  Maciej Stachowiak  <mjs@apple.com>

        Rubber stamped by Darin.

        - renamed ResourceLoader to ResourceHandle (and same for related classes)

        * WebCore.vcproj/WebCore.vcproj:
        * bridge/win/FrameWin.cpp:
        * platform/network/win/ResourceHandleWin.cpp: Added.
        (WebCore::):
        (WebCore::addToOutstandingJobs):
        (WebCore::lookupResourceHandle):
        (WebCore::ResourceHandleWndProc):
        (WebCore::ResourceHandle::onHandleCreated):
        (WebCore::ResourceHandle::onRequestRedirected):
        (WebCore::ResourceHandle::onRequestComplete):
        (WebCore::initializeOffScreenResourceHandleWindow):
        (WebCore::ResourceHandleInternal::~ResourceHandleInternal):
        (WebCore::ResourceHandle::~ResourceHandle):
        (WebCore::ResourceHandle::startHTTPRequest):
        (WebCore::ResourceHandle::start):
        (WebCore::ResourceHandle::fileLoadTimer):
        (WebCore::ResourceHandle::cancel):
        * platform/network/win/ResourceHandleWin.h: Added.
        * platform/network/win/ResourceLoaderWin.cpp: Removed.
        * platform/network/win/ResourceLoaderWin.h: Removed.
        * platform/win/TemporaryLinkStubs.cpp:
        (WebCore::ResourceHandle::assembleResponseHeaders):
        (WebCore::ResourceHandle::retrieveResponseEncoding):
        (IconLoader::receivedResponse):
        * plugins/win/PluginStreamWin.cpp:
        (WebCore::PluginStreamWin::start):
        (WebCore::PluginStreamWin::deliverData):
        (WebCore::PluginStreamWin::receivedResponse):
        (WebCore::PluginStreamWin::didReceiveData):
        (WebCore::PluginStreamWin::receivedAllData):
        * plugins/win/PluginStreamWin.h:

2006-10-28  Adam Roben  <aroben@apple.com>

        Build fix.

        * WebCore.vcproj/WebCore.vcproj: Adding new HitTestResult.{cpp,h}
        files.

2006-10-27  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Oliver.

        <rdar://problem/4730678> Plug-ins should be able to open URLs

        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::performRequest):

2006-10-26  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by John Sullivan.

        <rdar://problem/4764502> PluginStreams should cancel their loader jobs on error

        * plugins/win/PluginStreamWin.cpp:
        (WebCore::PluginStreamWin::receivedResponse):
        (WebCore::PluginStreamWin::didReceiveData):
        (WebCore::PluginStreamWin::receivedAllData):
        Modify assertions. None of the above functions should be run after aborting the load.

2006-10-26  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Adam.

        * plugins/win/PluginDatabaseWin.cpp:
        (WebCore::addPluginPath):
        (WebCore::PluginDatabaseWin::defaultPluginPaths):
        Look for plugins in a plugins directory which is relative to the executable directory.
        
        (WebCore::PluginDatabaseWin::createPluginView):
        Use reverseFind instead of findRev here.
        
2006-10-26  Adam Roben  <aroben@apple.com>

        Reviewed by Beth.

        Fix: <rdar://problem/4799084> Text and dropdown button too close
        together in <select>s
        Fix: <rdar://problem/4800493> Popup menus should be positioned so that
        their text is horizontally aligned with the <select> control's text

        * platform/win/PopupMenuWin.cpp:
        (WebCore::PopupMenu::calculatePositionAndSize): Switch alignment of LTR
        vs. RTL popups, and add padding to align the text.
        (WebCore::PopupMenu::paint): Add padding from the <select> control to
        align the text with the <select> control's text.
        * rendering/RenderThemeWin.cpp: Set svn:eol-style native.
        (WebCore::RenderThemeWin::systemFont): Clean up line endings.
        (WebCore::RenderThemeWin::adjustMenuListButtonStyle): Add some extra
        padding between the dropdown button and text.
        (WebCore::RenderThemeWin::paintMenuListButton): Clean up code a bit.

2006-10-26  Adam Roben  <aroben@apple.com>

        Forgot to make the change to Release as well in my last checkin.

        * WebCore.vcproj/WebCore.vcproj:

2006-10-26  Adam Roben  <aroben@apple.com>

        Rubberstamped by Steve.

        Add some missing '/d' flags to xcopy calls to only copy headers if
        they've been modified.

        * WebCore.vcproj/WebCore.vcproj:

2006-10-26  Anders Carlsson  <acarlsson@apple.com>

        * platform/win/TemporaryLinkStubs.cpp:
        (GraphicsContext::drawLineForMisspellingOrBadGrammar):
        Build fix from Oliver.
        
2006-10-26  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Adam.

        Use FrameLoadRequest and ResourceRequest instead of passing around
        the individual components.
        
        * plugins/win/PluginStreamWin.cpp:
        (WebCore::PluginStreamWin::PluginStreamWin):
        (WebCore::PluginStreamWin::start):
        (WebCore::PluginStreamWin::destroyStream):
        * plugins/win/PluginStreamWin.h:
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginRequestWin::PluginRequestWin):
        (WebCore::PluginRequestWin::frameLoadRequest):
        (WebCore::PluginViewWin::start):
        (WebCore::PluginViewWin::performRequest):
        (WebCore::PluginViewWin::load):
        (WebCore::PluginViewWin::getURLNotify):
        (WebCore::PluginViewWin::getURL):
        (WebCore::PluginViewWin::handlePost):
        * plugins/win/PluginViewWin.h:

2006-10-26  Adam Roben  <aroben@apple.com>

        Reviewed by Adele.

        Fix: <rdar://problem/4794162> Implement type-ahead find for popup menus
        Fix: <rdar://problem/4800486> Pressing TAB while a popup is focused
        should close the popup and move selection in the page

        * platform/win/PopupMenuWin.cpp:
        (WebCore::PopupMenu::PopupMenu): Don't cache the focused index.
        (WebCore::PopupMenu::focusedIndex): Always get the focused index from
        the HTMLSelectElement.
        (WebCore::PopupMenu::setFocusedIndex): Invalidate before calling
        valueChanged(), as this will change the result of focusedIndex().
        (WebCore::PopupMenu::scrollToRevealSelection):
        (WebCore::PopupMenu::updateFromElement): New method to repaint/rescroll
        the popup.
        (WebCore::PopupWndProc): Send TAB keypresses and printable characters
        back to the WebView for handling. Also omove handling of Return/Escape
        into the WM_CHAR event, as this is recommended by MSDN.

2006-10-25  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by Darin.

        Checked in Luke's CG printing code

        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::setupRootForPrinting): Added
        (WebCore::FrameWin::computePageRects): Added
        * bridge/win/FrameWin.h: Added setupRootForPrinting, computePageRects

2006-10-24  Maciej Stachowiak  <mjs@apple.com>

        Reviewed by Oliver.

        - updated for ResourceRequest changes.

        * plugins/win/PluginStreamWin.cpp:
        (WebCore::PluginStreamWin::setRequestHeaders):
        * plugins/win/PluginStreamWin.h:
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::loadURL):
        (WebCore::parseRFC822HeaderFields):
        (WebCore::PluginViewWin::handlePost):
        * plugins/win/PluginViewWin.h:

2006-10-24  Steve Falkenburg  <sfalken@apple.com>

        Build fix for official builds

        * WebCore.vcproj/WebCore.make:

2006-10-24  Steve Falkenburg  <sfalken@apple.com>

        Fix build so it can be submitted.

        * WebCore.vcproj/WebCore.vcproj:
        * WebCore.vcproj/merge-opensource.sh:
        * rendering/RenderThemeWin.cpp:

2006-10-24  Geoffrey Garen  <ggaren@apple.com>

        Rolling back in, now fixed:
        
        Nixed a few more redundant loading functions in Frame.

        * bridge/win/FrameWin.h:
        * platform/win/TemporaryLinkStubs.cpp:
        (FrameWin::shouldInterruptJavaScript):
        (FrameWin::lastEventIsMouseUp):

2006-10-24  Maciej Stachowiak  <mjs@apple.com>

        Reviewed by Geoff.

        - update for ResourceLoader API changes

        * platform/win/TemporaryLinkStubs.cpp:
        (WebCore::ServeSynchronousRequest):
        * plugins/win/PluginStreamWin.cpp:
        (WebCore::PluginStreamWin::start):
        (WebCore::PluginStreamWin::receivedAllData):
        * plugins/win/PluginStreamWin.h:
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::performRequest):

2006-10-24  Geoffrey Garen  <ggaren@apple.com>

        Rolling out my last change because it broke the world.
        
        * bridge/win/FrameWin.h:
        * platform/win/TemporaryLinkStubs.cpp:
        (FrameWin::openURL):

2006-10-24  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Adam.

        <rdar://problem/4760429> Crash in PluginStreamWin::~PluginStreamWin when 
        navigating away from mcdonalds.com
        
        * plugins/win/PluginPackageWin.cpp:
        (WebCore::PluginPackageWin::fetchInfo):
        Use fastFree instead of free when memory is allocated by fastMalloc. 
        If the plugin name or description is null, don't try to fetch info about the plugin.
        
        * plugins/win/PluginStreamWin.cpp:
        (WebCore::PluginStreamWin::setRequestHeaders):
        (WebCore::PluginStreamWin::start):
        (WebCore::PluginStreamWin::stop):
        * plugins/win/PluginStreamWin.h:
        Change type of header map to ResourceRequest::HTTPHeaderMap. When a plugin is stopped,
        set its state to StreamStopped.
        
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::loadURL):
        (WebCore::parseRFC822HeaderFields):
        (WebCore::PluginViewWin::handlePost):
        * plugins/win/PluginViewWin.h:
        Update for type changes to the header map.

2006-10-24  Geoffrey Garen  <ggaren@apple.com>

        Reviewed by Anders.
        
        Nixed a few more redundant loading functions in Frame.

        * bridge/win/FrameWin.h:
        * platform/win/TemporaryLinkStubs.cpp:
        (FrameWin::shouldInterruptJavaScript):
        (FrameWin::lastEventIsMouseUp):

2006-10-23  Geoffrey Garen  <ggaren@apple.com>

        Reviewed by Bradee.

        Removed methods from BrowserExtension.

        * bridge/win/FrameWin.h:
        * platform/win/TemporaryLinkStubs.cpp:
        (FrameWin::canPaste):
        (FrameWin::canGoBackOrForward):
        (FrameWin::goBackOrForward):
        (FrameWin::getHistoryLength):
        (FrameWin::historyURL):
        (Page::canRunModal):
        (Page::canRunModalNow):
        (Page::runModal):
        (BrowserExtensionWin::BrowserExtensionWin):

2006-10-23  Adam Roben  <aroben@apple.com>

        Reviewed by Adele.

        Fix: <rdar://problem/4796994> Styled <select>s should still use Windows
        theme

        The fix is to do most of our drawing for menulists in
        RenderThemeWin::paintMenuListButton (which is called for styled
        <select>s), and then do any extra drawing for unstyled <select>s in
        RenderThemeWin::paintMenuList.

        * rendering/RenderThemeWin.cpp:
        (WebCore::RenderThemeWin::getThemeData): Case for
        MenulistButtonAppearance should be the same as MenulistAppearance.
        (WebCore::RenderThemeWin::paintMenuList): Draw the border, then defer
        to paintMenuListButton to handle the rest of painting.
        (WebCore::RenderThemeWin::adjustMenuListStyle): Reset the border so we
        can draw our own, then defer to adjustMenuListStyle.
        (WebCore::RenderThemeWin::adjustMenuListButtonStyle): Code moved from
        adjustMenuListStyle, less the call to resetBorder().
        (WebCore::RenderThemeWin::paintMenuListButton): Code moved from
        paintMenuList, less the border-drawing code.
        * rendering/RenderThemeWin.h:

2006-10-23  Adam Roben  <aroben@apple.com>

        Reviewed by Adele.

        Fix: <rdar://problem/4786759> PageUp/PageDown/Home/End don't work in
        <select> menus

        * platform/win/PopupMenuWin.cpp:
        (WebCore::PopupMenu::setFocusedIndex): Only call ::UpdateWindow if we
        didn't scroll, because scrolling will do the update for us.
        (WebCore::PopupMenu::focusFirst): New method.
        (WebCore::PopupMenu::focusLast): New method.
        (WebCore::PopupMenu::down): Add a parameter to specify how far we
        should try to move the selection.
        (WebCore::PopupMenu::up): Ditto.
        (WebCore::PopupMenu::invalidateItem): Cleanup code by using IntRect
        instead of RECT.
        (WebCore::PopupMenu::scrollTo): Return a boolean to say whether
        scrolling actually happened.
        (WebCore::PopupMenu::scrollToRevealSelection): Ditto.
        (WebCore::PopupWndProc): Handle PageUp/PageDown/Home/End.

2006-10-23  Adam Roben  <aroben@apple.com>

        Build fix.

        * WebCore.vcproj/WebCore.vcproj: Copy headers from new platform/network
        directory and subdirectories.

2006-10-23  Adam Roben  <aroben@apple.com>

        Build fix.

        * plugins/win/PluginStreamWin.h: Rename methods to match Maciej's
        changes.

2006-10-23  Adam Roben  <aroben@apple.com>

        Build fix.

        * WebCore.vcproj/WebCore.vcproj: Copied AdditionalIncludeDirectories
        from Release to All Configurations.

2006-10-23  Maciej Stachowiak  <mjs@apple.com>

        Rubber-stamped by Anders.

        - fixed for ResourceLoader refactoring.

        * platform/network/win/ResourceLoaderWin.cpp:
        (WebCore::ResourceLoader::onRequestComplete):
        (WebCore::ResourceLoader::fileLoadTimer):
        (WebCore::ResourceLoader::cancel):
        * plugins/win/PluginStreamWin.cpp:
        (WebCore::PluginStreamWin::didReceiveData):
        (WebCore::PluginStreamWin::didFinishLoading):
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::performRequest):

2006-10-22  Maciej Stachowiak  <mjs@apple.com>

        Reviewed by Anders.

        - updated for new ResourceLoader file locations.

        * WebCore.vcproj/WebCore.vcproj: Updated file paths.
        * platform/win/ResourceLoaderWin.cpp: Moved to platform/network/win
        * platform/win/ResourceLoaderWin.h: ditto

2006-10-22  Adam Roben  <aroben@apple.com>

        Reviewed by Steve.

        Fix some crashes caused by the <select> element being detached while
        the popup is open.

        * platform/win/PopupMenuWin.cpp:
        (WebCore::PopupWndProc):

2006-10-21  Adam Roben  <aroben@apple.com>

        Reviewed by Anders.

        Fix: <rdar://problem/4794151> Popup should scroll to reveal selected
        item, not just one line at a time
        Fix: <rdar://problem/4794229> Popup hot-tracking should not change text
        in <select> control

        * platform/win/PopupMenuWin.cpp:
        (WebCore::PopupMenu::calculatePositionAndSize): Cleaned up code by
        translating into screen coordinates right away.
        (WebCore::PopupMenu::setFocusedIndex): Added parameter to specify
        whether the text in the <select> control should be updated.
        (WebCore::PopupMenu::scrollTo): Extracted scrolling code from
        PopupWndProc to here.
        (WebCore::PopupMenu::scrollToRevealSelection): New method.
        (WebCore::PopupWndProc): Use scrollToRevealSelection() instead of
        manually scrolling one line at a time. Fixed a bug in detecting a
        mouse drag.  Pass in HDC from ::BeginPaint to PopupMenu::paint.

2006-10-21  Adam Roben  <aroben@apple.com>

        Build fix.

        * WebCore.vcproj/WebCore.vcproj: Add new DeleteButton* files to
        project.

2006-10-20  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by Anders.

        Turn on CFNetwork

        * config.h:

2006-10-20  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by Ada.

        <rdar://4778502> Boomer userAgent string needs to support pulling in proper build #, plus customization

        Useragent/versioning changes
        
        Stamp auto-generated version number into DLL and into user agent.
        Generate a real user agent string instead of hardcoding one.
        Support client supplying an application name for the user agent.
        Support client overriding the useragent (for debug menu).
        Support per-URL user agents (not used at least for now).

        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::userAgent): Now calls userAgentForURL
        (WebCore::FrameWin::originalRequestURL): Implemented
        * bridge/win/FrameWin.h: changed userAgent to userAgentForURL, added originalRequestURL
        * platform/win/TemporaryLinkStubs.cpp: Removed originalRequestURL

2006-10-20  Alice Liu  <alice.liu@apple.com>

        Reviewed by Steve.

        Adding knowledge of the Editor and EditorClient to Windows WebCore

        No layout tests needed
        
        * WebCore.vcproj/WebCore.vcproj:
        added Sound.h, SoundWin.cpp, EditorClient.h, Editor.h&.cpp

        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::FrameWin):
        added client to constructor params

        * bridge/win/FrameWin.h:
        added client to constructor params

        * platform/win/SoundWin.cpp: Added.
        (WebCore::systemBeep):
        Calls windows system beep

2006-10-19  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by Adam.

        <rdar://4771958> Holding down Ctrl when a redirect happens opens the redirected page in a new tab
        
        Send triggering event to url selection.

        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::urlSelected): Add triggeringEvent parameter
        * bridge/win/FrameWin.h: Add triggeringEvent parameter
        * platform/win/PlatformMouseEventWin.cpp:
        (WebCore::PlatformMouseEvent::PlatformMouseEvent): Call GetKeyState instead of GetAsyncKeyState
        * platform/win/WheelEventWin.cpp:
        (WebCore::PlatformWheelEvent::PlatformWheelEvent): Call GetKeyState instead of GetAsyncKeyState

2006-10-19  Adam Roben  <aroben@apple.com>

        Reviewed by Ada.

        This is a partial reimplementation of PopupMenu for Windows. The old
        implementation used the Win32 ListBox control, but as we needed to
        customize the behavior more and more it began to make sense to roll our
        own popup from scratch. That is what this patch accomplishes. And...

        Fix: <rdar://problem/4709416>
        Implement mouse hot-tracking for <select> menus
        Fix: <rdar://problem/4786763>
        Can select disabled options in <select> menus using mouse
        (It was easier to implement these than to leave them broken.)

        * WebCore.vcproj/WebCore.vcproj: Removed PopupMenu.cpp from project.
        * platform/win/PopupMenuWin.cpp: Carnage. PopupMenu has gained a slew
        of new private instance variables to maintain the window state.
        m_container has been removed as it is no longer needed.
        (WebCore::PopupMenu::PopupMenu): Initialize new variables.
        (WebCore::PopupMenu::~PopupMenu): Clean up new variables.
        (WebCore::PopupMenu::show): Now that we don't have m_container, m_popup
        gets the WS_BORDER and WS_POPUP styles. Also moved code to animate the
        window out of the old PopupMenu::setPositionAndSize() into this method
        since it fits the purpose of this method better.
        (WebCore::PopupMenu::hide):
        (WebCore::PopupMenu::calculatePositionAndSize): Renamed from
        setPositionAndSize(), as this method no longer actually sets the window
        position and size, just calculates it. It also now makes sure the
        window is sized to never show partial items, and takes into account the
        window's border when calculating the size.
        (WebCore::PopupMenu::setFocusedIndex): New method to handle setting the
        selected index of the <select> and highlighting the item in the popup menu.
        (WebCore::PopupMenu::down): Use setSelectedIndex() to do the dirty work.
        (WebCore::PopupMenu::up): Ditto.
        (WebCore::PopupMenu::invalidateItem): New method to invalidate the
        rectangle in the popup menu for this item.
        (WebCore::PopupMenu::clientRect): New method to calculate an IntRect
        for the client area of the window.
        (WebCore::PopupMenu::incrementWheelDelta): New method to add the wheel
        delta obtained from a WM_MOUSEWHEEL message to any pre-existing delta.
        (WebCore::PopupMenu::reduceWheelDelta): New method to reduce the
        pre-existing wheel delta by a given amount towards 0.
        (WebCore::PopupMenu::paint): Does the work that PopupMenu::drawItem
        did, but for every item contained within the damageRect. Can also paint
        into a passed-in HDC (needed for window animations and smooth-scrolling).
        (WebCore::registerPopup): Changed a void* to a PopupMenu*, since that's
        what it really is.
        (WebCore::PopupWndProc): Added code to handle all the messages any
        self-respecting window would handle, and removed messages only relevant
        to the ListBox control.
        * platform/win/TemporaryLinkStubs.cpp: Removed unneeded #include.

2006-10-19  Adam Roben  <aroben@apple.com>

        Rubberstamped by Maciej.

        Build fix.

        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::submitForm):

2006-10-19  Maciej Stachowiak  <mjs@apple.com>

        Reviewed by Steve.

        - speculative build fix for Windows for my recent changes.

        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::submitForm):

2006-10-19  Anders Carlsson  <acarlsson@apple.com>

       * platform/win/TemporaryLinkStubs.cpp:
        (WebCore::ResourceLoader::retrieveResponseEncoding):
        Build fix.

2006-10-18  Maciej Stachowiak  <mjs@apple.com>

        Reviewed by Geoff.

        - remove remnants of KXMLCore name.

        * WebCore.vcproj/WebCore.vcproj:
        * config.h:

2006-10-18  Steve Falkenburg  <sfalken@apple.com>

        Fix build

        * platform/win/TemporaryLinkStubs.cpp:
        (BrowserExtensionWin::historyURL):
        (BrowserExtensionWin::BrowserExtensionWin):

2006-10-17  Steve Falkenburg  <sfalken@apple.com>

        Build fix

        * platform/win/TemporaryLinkStubs.cpp:
        (BrowserExtensionWin::createNewWindow):

2006-10-17  Geoffrey Garen  <ggaren@apple.com>

        Reviewed by Anders.
        
        Added WindowFeatures.h to the project.

        * WebCore.vcproj/WebCore.vcproj:

2006-10-17  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by Maciej.

        Turn off a very noisy warning (unknown pragma) caused by an Interfacer include

        * WebCore.vcproj/WebCore.vcproj:

2006-10-17  Oliver Hunt  <oliver@apple.com>

        Reviewed by Brady.

        Fixed alpha in favicons, added composite operation conversion
        for cg
        
        rdar://problem/4758934

        * platform/win/GraphicsContextWin.cpp:
        (WebCore::GraphicsContext::setCompositeOperation):
        * platform/win/ImageWin.cpp:
        (WebCore::Image::getHBITMAP):
        * platform/win/TemporaryLinkStubs.cpp:
        (GraphicsContext::drawLineForMisspelling):

2006-10-15  Geoffrey Garen  <ggaren@apple.com>

        Reviewed by Adam.

        Added HTMLFrameElementBase to the project.
        
        * WebCore.vcproj/WebCore.vcproj:

2006-10-17  Adam Roben  <aroben@apple.com>

        Reviewed by Geoff.

        A couple of cleanups that Geoff suggested after my last checkin.

        * platform/win/PopupMenuWin.cpp:
        (WebCore::PopupMenu::setPositionAndSize):

2006-10-17  Adam Roben  <aroben@apple.com>

        Reviewed by Adele.

        Fix: <rdar://problem/4772506> <select> popup menu should not clip items
        when width: is set.

        Popups are now sized and positioned as follows:
        1. Popups are at least as wide as the <select> control on the page.
        2. Popups for LTR <select>s are right-aligned with the <select>, popups
           for RTL <select>s are left-aligned. This means the scrollbar in the
           popup will always line up with the dropdown button in the <select>.
        3. Popups try to be wide enough to fit their widest item, but will
           shrink to ensure they don't extend off the screen.

        * platform/win/PopupMenuWin.cpp:
        (WebCore::PopupMenu::setPositionAndSize):

2006-10-16  Adam Roben  <aroben@apple.com>

        Reviewed by Kevin.

        Fix: <rdar://problem/4758923> <select> menu text doesn't draw right
        aligned on right-to-left sites

        * platform/win/PopupMenuWin.cpp:
        (WebCore::PopupMenu::show): Pass appropriate styles to CreateWindowEx
        so that we get a left-aligned scrollbar in RTL popups.
        (WebCore::PopupMenu::drawItem): Set text to be right-aligned and draw
        RTL when direction:rtl is set.
        (WebCore::PopupWndProc): Add 1px of vertical height to each menu item
        to match RenderListBox.
        * rendering/RenderThemeWin.cpp:
        (WebCore::RenderThemeWin::paintMenuList): Draw the dropdown button on
        the left when in RTL.
        (WebCore::RenderThemeWin::adjustMenuListStyle): Set padding to allow
        for the dropdown button being on the left in RTL.

2006-10-16  Adam Roben  <aroben@apple.com>

        Reviewed by John.

        Forgot to save these changes John suggested before checking in.

        * platform/win/PopupMenuWin.cpp:
        (WebCore::PopupMenu::drawItem):

2006-10-16  Adam Roben  <aroben@apple.com>

        Reviewed by John.

        Fix: <rdar://problem/4709480> Implement option groups
        Fix: <rdar://problem/4785693> Use CG to draw popup menu items
        Fix: <rdar://problem/4709487> Implement separators in <select> popups
        Fix: <rdar://problem/4709358> Move CreateWindowEx calls out of PopupMenu constructor

        * platform/win/PopupMenuWin.cpp: Added some now-required #includes,
        moved some constants into the WebCore namespace.
        (WebCore::PopupMenu::PopupMenu): Moved CreateWindowEx calls into PopupMenu::show().
        (WebCore::PopupMenu::show): Pass LBS_OWNERDRAWFIXED to CreateWindowEx
        to assume responsibility for drawing menu itesm. Removed call to set
        the font on the popup menu, as CG will take care of this.
        (WebCore::addString): Added to help with the PopupMenu::add* methods.
        (WebCore::PopupMenu::addOption): Use addString.
        (WebCore::PopupMenu::addGroupLabel): Ditto, and moved from TemporaryLinkStubs.cpp.
        (WebCore::PopupMenu::addSeparator): Ditto.
        (WebCore::PopupMenu::down): Skip items that are not enabled <option>
        elements, and tell the popup menu to set the selection to the element
        we end up on.
        (WebCore::PopupMenu::up): Ditto.
        (WebCore::PopupMenu::drawItem): Added. This is the method that is
        called to draw each item in the menu.
        (WebCore::PopupWndProc): Add cases for WM_MEASUREITEM and WM_DRAWITEM
        messages (required now that we're drawing the menu items ourselves). In
        the cases for arrow key presses, return -2 to signify that we're
        handling all aspects of changing the selection.
        * platform/win/TemporaryLinkStubs.cpp: Removed PopupMenu::addSeparator
        and PopupMenu::addGroupLabel.

2006-10-15  Adam Roben  <aroben@apple.com>

        Build fix.

        Merge OpenSource r17056 to TemporaryLinkStubs.cpp.

        * platform/win/TemporaryLinkStubs.cpp:
        (WebCore::CacheObjectExpiresTime):
        (WebCore::ResponseIsMultipart):
        (WebCore::ResponseMIMEType):
        (WebCore::IsResponseURLEqualToURL):
        (WebCore::ResponseURL):
        (WebCore::CachedResource::setResponse):
        (WebCore::CachedResource::setAllData):

2006-10-13  Maciej Stachowiak  <mjs@apple.com>

        Reviewed by Darin.

        - split FrameLoadRequest off from ResourceRequest - it's a ResourceRequest plus frame name plus lockHistory bool

        * WebCore.vcproj/WebCore.vcproj:
        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::urlSelected):
        (WebCore::FrameWin::submitForm):
        * bridge/win/FrameWin.h:
        * platform/win/TemporaryLinkStubs.cpp:
        (BrowserExtensionWin::createNewWindow):
        (IconLoader::notifyIconChanged):

2006-10-13  Dave Hyatt  <hyatt@apple.com>

        Make form controls work inside transparency layers by having
        them draw into bitmap that is then turned into a CGImageRef
        and blended into the CG transparency layer.

        Reviewed by aroben

        * platform/cg/GraphicsContextPlatformPrivate.h:
        (WebCore::GraphicsContextPlatformPrivate::GraphicsContextPlatformPrivate):
        (WebCore::GraphicsContextPlatformPrivate::beginTransparencyLayer):
        (WebCore::GraphicsContextPlatformPrivate::endTransparencyLayer):
        * platform/win/GraphicsContextWin.cpp:
        (WebCore::GraphicsContext::getWindowsContext):
        (WebCore::GraphicsContext::releaseWindowsContext):
        * platform/win/IconWin.cpp:
        (WebCore::Icon::paint):
        * platform/win/PlatformScrollBar.h:
        * platform/win/PlatformScrollBarWin.cpp:
        (WebCore::PlatformScrollbar::PlatformScrollbar):
        (WebCore::PlatformScrollbar::paint):
        (WebCore::PlatformScrollbar::paintButton):
        (WebCore::PlatformScrollbar::paintTrack):
        (WebCore::PlatformScrollbar::paintThumb):
        * rendering/RenderThemeWin.cpp:
        (WebCore::RenderThemeWin::RenderThemeWin):
        (WebCore::drawControl):

2006-10-12  Dave Hyatt  <hyatt@apple.com>

        Voting Cairo off the island

        or

        Jeff Probst: "Cairo, the tribe has spoken.  It's time for you
        to go."

        * WebCore.vcproj/WebCore.vcproj:
        * platform/win/FontDataWin.cpp:
        (WebCore::FontData::platformInit):
        (WebCore::FontData::platformDestroy):
        (WebCore::FontData::platformWidthForGlyph):
        * platform/win/FontPlatformData.h:
        (WebCore::FontPlatformData::FontPlatformData):
        (WebCore::FontPlatformData::hfont):
        (WebCore::FontPlatformData::cgFont):
        (WebCore::FontPlatformData::operator==):
        * platform/win/FontPlatformDataWin.cpp:
        * platform/win/FontWin.cpp:
        (WebCore::Font::drawGlyphs):
        * platform/win/GraphicsContextWin.cpp:
        * platform/win/IconWin.cpp:
        * platform/win/ImageWin.cpp:
        (WebCore::Image::loadPlatformResource):
        * platform/win/TemporaryLinkStubs.cpp:
        (GraphicsContextPlatformPrivate::clip):
        (GraphicsContext::drawLineForMisspelling):

2006-10-12  Adele Peterson  <adele@apple.com>

        RS by Geoff.

        Renamed uploadControlDetaching to disconnectUploadControl.

        * platform/win/FileChooserWin.cpp:
        (WebCore::FileChooser::disconnectUploadControl):

2006-10-12  Adele Peterson  <adele@apple.com>

        Reviewed by Alice. 

        Fixed a small oversight from the last checkin.  The populate method was calling itself, 
        instead of the newly renamed addItems method.

        * platform/win/PopupMenuWin.cpp:
        (WebCore::PopupMenu::populate):

2006-10-12  Adam Roben  <aroben@apple.com>

        Reviewed by Adele.

        Move popup menu code out of rendering/ and into platform/.
        RenderPopupMenu becomes PopupMenu, the
        RenderPopupMenuMac/RenderPopupMenuWin subclasses and all the associated
        virtual methods go away, RenderTheme gets to stop worrying about popup
        menus, PopupMenu becomes ref-counted, and everyone becomes happy.

        Also fixes <rdar://problem/4710456> Get rid of RenderPopupMenu{Win,Mac}
        classes.

        * WebCore.vcproj/WebCore.vcproj: Move files within project.
        * platform/win/PopupMenuWin.cpp: Moved from
        rendering/RenderPopupMenuWin.cpp. Rename RenderPopupMenuWin to
        PopupMenu.
        (WebCore::PopupMenu::PopupMenu):
        (WebCore::PopupMenu::~PopupMenu):
        (WebCore::PopupMenu::clear):
        (WebCore::PopupMenu::populate):
        (WebCore::PopupMenu::show):
        (WebCore::PopupMenu::hide):
        (WebCore::PopupMenu::setPositionAndSize):
        (WebCore::PopupMenu::addOption):
        (WebCore::PopupMenu::focusedIndex): New method to get the index of the
        element that is currently highlighted. This won't always be the same as
        the selectedIndex because of mouse hot-tracking.
        (WebCore::PopupMenu::down):
        (WebCore::PopupMenu::up):
        (WebCore::registerPopup):
        (WebCore::PopupWndProc): Use focusedIndex() instead of sending messages
        to the popup window.
        * platform/win/TemporaryLinkStubs.cpp: Rename RenderPopupMenuWin to PopupMenu.
        (PopupMenu::addSeparator):
        (PopupMenu::addGroupLabel):
        * rendering/RenderPopupMenuWin.cpp: Removed.
        * rendering/RenderPopupMenuWin.h: Removed.
        * rendering/RenderThemeWin.cpp: Get rid of createPopupMenu() method.
        * rendering/RenderThemeWin.h: Ditto.

2006-10-12  Dave Hyatt  <hyatt@apple.com>

        Implement full-blown double buffering (keeping a bitmap in the WebView that holds the backing store for it).
        
        Reviewed by mjs

        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::addToDirtyRegion):
        (WebCore::FrameWin::scrollBackingStore):
        (WebCore::FrameWin::updateBackingStore):
        * bridge/win/FrameWin.h:
        * platform/win/PlatformScrollBar.h:
        * platform/win/PlatformScrollBarWin.cpp:
        (WebCore::PlatformScrollbar::windowClipRect):
        * platform/win/ScrollViewWin.cpp:
        (WebCore::ScrollView::ScrollViewPrivate::valueChanged):
        (WebCore::ScrollView::ScrollViewPrivate::windowClipRect):
        (WebCore::ScrollView::updateContents):
        (WebCore::ScrollView::updateScrollbars):
        (WebCore::ScrollView::windowResizerRect):
        (WebCore::ScrollView::addToDirtyRegion):
        (WebCore::ScrollView::scrollBackingStore):
        (WebCore::ScrollView::updateBackingStore):
        * platform/win/WidgetWin.cpp:
        (WebCore::Widget::suppressInvalidation):
        (WebCore::Widget::invalidateRect):
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::windowClipRect):

2006-10-11  Adam Roben  <aroben@apple.com>

        Rubberstamped by Brady.

        Clean up logic in Icon::newIconForFile.

        * platform/win/IconWin.cpp:
        (WebCore::Icon::newIconForFile): Error case should return early.

2006-10-11  Adam Roben  <aroben@apple.com>

        Reviewed by Steve.

        Fixes <rdar://problem/4777719>
        Icons don't paint with CG

        * platform/win/IconWin.cpp:
        (WebCore::Icon::paint): Remove Cairo-specific code now that we have
        GraphicsContextWin.

2006-10-11  Adam Roben  <aroben@apple.com>

        Rubberstamped by Anders.

        Clean up FileChooser::create, Icon::create.

        * platform/win/FileChooserWin.cpp:
        (WebCore::FileChooser::create): Just return a FileChooser* and let the
        implicit cast happen.
        * platform/win/IconWin.cpp:
        (WebCore::Icon::newIconForFile): Ditto for Icon*.

2006-10-10  Adam Roben  <aroben@apple.com>

        Reviewed by Oliver.

        Fixes <rdar://problem/4731316>
        Crash when <input type="file"> element removed while file chooser is open

        * platform/win/FileChooserWin.cpp: Make FileChooser ref-counted.
        (WebCore::FileChooser::create):
        (WebCore::FileChooser::openFileChooser): Add a protector RefPtr around
        the call to GetOpenFileName so we don't get deleted while the file
        chooser window is open.

2006-10-10  Adam Roben  <aroben@apple.com>

        Reviewed by Anders.

        Fixes <rdar://problem/4772428>
        <select> popup menus positioned incorrectly within frames

        * rendering/RenderPopupMenuWin.cpp:
        (WebCore::RenderPopupMenuWin::setPositionAndSize): Use
        contentsToWindow() instead of scrollOffset() to correct menu location.

2006-10-10  Adam Roben  <aroben@apple.com>

        Reviewed by Adele.

        Fixes <rdar://problem/4763246>
        Using arrow keys in <select> popup fires onChange event

        Also updates text shown in <select> element on page when using arrow
        keys to change selection within the popup menu, and makes onChange fire
        in the same cases as Firefox/IE.

        * rendering/RenderPopupMenuWin.cpp:
        (WebCore::RenderPopupMenuWin::down): Update text of the <select>
        control. Change call to valueChanged() so that onChange doesn't fire.
        (WebCore::RenderPopupMenuWin::up): Ditto.
        (WebCore::PopupWndProc): Don't fire onChange anytime selection changes.
        Fire onChange when pressing Enter

2006-10-09  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Maciej.

        Fix <rdar://problem/4756255>
        PDF/Acrobat Reader plugin don't work
        
        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::getObjectInstanceForWidget):
        (WebCore::FrameWin::getEmbedInstanceForWidget):
        Implement these, getting the instance from the plugin view.
        
        * platform/win/TemporaryLinkStubs.cpp:
        Remove functions that are now implemented.
        
        * plugins/win/PlugInInfoStoreWin.cpp:
        (WebCore::PlugInInfoStore::pluginCount):
        (WebCore::PlugInInfoStore::supportsMIMEType):
        Implement this, returning whether we a plugin exists for a given mime type.
        
        * plugins/win/PluginDatabaseWin.cpp:
        (WebCore::parseVersionString):
        (WebCore::compareVersions):
        New functions for handling versions.
        
        (WebCore::addMozillaPluginPaths):
        (WebCore::addWindowsMediaPlayerPluginPath):
        (WebCore::addQuickTimePluginPath):
        (WebCore::addJavaPluginPath):
        (WebCore::addAdobeAcrobatPluginPath):
        (WebCore::PluginDatabaseWin::defaultPluginPaths):
        Factor out checks into separate functions, add checks for Java and Adobe Acrobat.

        (WebCore::PluginDatabaseWin::isMIMETypeRegistered):
        Handle null MIME types.
        
        * plugins/win/PluginPackageWin.cpp:
        (WebCore::PluginPackageWin::load):
        Add some missing functions. Unload the library if the load failed.
        
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::getValue):
        Uncomment code for getting the element object.
        
        (WebCore::PluginViewWin::bindingInstance):
        * plugins/win/PluginViewWin.h:
        New function which fetches the plugin NPObject and wraps it in an instance.

2006-10-09  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Steve.

        Fix <rdar://problem/4773320>
        Safari didn't pick up quicktime that was already installed
        
        * plugins/win/PluginDatabaseWin.cpp:
        (WebCore::PluginDatabaseWin::defaultPluginPaths):
        
2006-10-09  Anders Carlsson  <acarlsson@apple.com>

        * WebCore.vcproj/WebCore.vcproj:
        * bridge/win/FrameWin.h:
        * platform/win/TemporaryLinkStubs.cpp:
        (FrameWin::createJavaAppletWidget):
        Fix build.

2006-10-09  Adam Roben  <aroben@apple.com>

        Reviewed by Adele.

        Fixes <rdar://problem/4773142>
        Crash in Settings::mediumFontSize() on ebay.com

        Call cancelAndClear() from ~FrameWin (just like Mac does) so we don't
        end up calling the Frame::saveDocumentState, which is pure virtual.

        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::~FrameWin):

2006-10-08  Adam Roben  <aroben@apple.com>

        Reviewed by Maciej.

        Port of OpenSource r16526, r16528

        Break up ResourceLoaderWndProc into callback functions.

        * platform/win/ResourceLoaderWin.cpp: Fix up #includes
        (WebCore::): Remove loadStatusMessage, struct JobLoadStatus, add
        messageHandlers array.
        (WebCore::ResourceLoaderWndProc): Split handling of different messages
        into callbacks.
        (WebCore::ResourceLoader::onHandleCreated): New callback.
        (WebCore::ResourceLoader::onRequestRedirected): New callback.
        (WebCore::ResourceLoader::onRequestComplete): New callback.
        (WebCore::initializeOffScreenResourceLoaderWindow): No need to register
        loadStatusMessage anymore.
        (WebCore::transferJobStatusCallback): Change how information is passed
        into ResourceLoaderWndProc.

2006-10-08  Dave Hyatt  <hyatt@apple.com>

        Add support for the Win2k/Classic theme for all controls.

        * rendering/RenderThemeWin.cpp:
        (WebCore::RenderThemeWin::buttonTheme):
        (WebCore::RenderThemeWin::textFieldTheme):
        (WebCore::RenderThemeWin::menuListTheme):
        (WebCore::RenderThemeWin::supportsHover):
        (WebCore::RenderThemeWin::determineClassicState):
        (WebCore::RenderThemeWin::getClassicThemeData):
        (WebCore::RenderThemeWin::getThemeData):
        (WebCore::drawControl):
        (WebCore::RenderThemeWin::paintButton):
        (WebCore::RenderThemeWin::paintTextField):
        (WebCore::RenderThemeWin::paintMenuList):
        * rendering/RenderThemeWin.h:
        (WebCore::ThemeData::m_state):

2006-10-07  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by Adam.

        Fix <rdar://4772205> Regression (r10623): WinInet loader doesn't ever write to the cache.        

        * platform/win/ResourceLoaderWin.cpp:
        (WebCore::ResourceLoaderWndProc): Apply POST related flags only for posts.
        (WebCore::ResourceLoader::startHTTPRequest): Don't add no-cache-write flag to non-post transactions.

2006-10-07  Dave Hyatt  <hyatt@apple.com>

        Add code to paint the Windows 2000 and "Windows Classic" theme look for scrollbars.

        * platform/win/PlatformScrollBarWin.cpp:
        (WebCore::PlatformScrollbar::paintButton):
        (WebCore::PlatformScrollbar::paintTrack):
        (WebCore::PlatformScrollbar::paintThumb):
        (WebCore::PlatformScrollbar::paintGripper):

2006-10-07  Dave Hyatt  <hyatt@apple.com>

        Make sure frames and iframes honor scrolling="no" and
        margins.

        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::createFrame):

2006-10-07  Dave Hyatt  <hyatt@apple.com>

        Fix the resizer rect so that it is in the ScrollView's coordinate space and not in the document's coordinate space.
        (Fixes all the layout errors with the scrollbar overlapping the resizer.)
        
        Fill scroll corners with white, since it matches Mac (and our chosen resizer look) and looks nicer anyway.
        
        * platform/win/ScrollViewWin.cpp:
        (WebCore::ScrollView::updateScrollbars):
        (WebCore::ScrollView::paint):

2006-10-06  Dave Hyatt  <hyatt@apple.com>

        Make sure to update plugin clip regions when scrollbars come and go on a scrollview.
       
        * platform/win/ScrollViewWin.cpp:
        (WebCore::ScrollView::updateScrollbars):

2006-10-06  Dave Hyatt  <hyatt@apple.com>

        Revise the cached clip rect so that it is in the HWND's coordinate space.  This way SetWindowRgn
        doesn't get wastefully called when the plugin is scrolled.
       
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::updateHwnd):

2006-10-06  Dave Hyatt  <hyatt@apple.com>

        Implement flawless clipping of windowed plugins, including
        respecting nested frames, CSS overflow and CSS clip.  (This
        puts Boomer way ahead of Mac as far as plugin clipping is
        concerned).
        
        Implement support for correct blitting of scrolled subframes,
        even when clipped by enclosing scrollviews.

        Fix a crash caused by focused children not being cleaned up
        when they are removed from a scrollview.

        * platform/win/ScrollViewWin.cpp:
        (WebCore::ScrollView::ScrollViewPrivate::valueChanged):
        (WebCore::ScrollView::setFrameGeometry):
        (WebCore::ScrollView::addChild):
        (WebCore::ScrollView::removeChild):
        (WebCore::ScrollView::geometryChanged):
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::updateHwnd):
        (WebCore::PluginViewWin::windowClipRect):
        (WebCore::PluginViewWin::setFrameGeometry):
        (WebCore::PluginViewWin::geometryChanged):
        * plugins/win/PluginViewWin.h:

2006-10-06  Geoffrey Garen  <ggaren@apple.com>

        Fixed <rdar://4768789> Crash on ebay.com in Frame::didOpenURL
        
        The issue was a resource loader making a callback to a
        frame after the frame had been destroyed. This doesn't happen on Mac
        because Mac WebKit cancels all loads before tearing down frames.
        
        The solution is to add a callback to Win WebKit to allow a frame
        to cancel its main resource load. This is a temporary work-around.
        It is temporary because it doesn't address pending subresource loads.
        The long-term solution we anticipate is to have a legitimate loader
        inside WebCore.

        * ChangeLog:
        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::~FrameWin):
        * bridge/win/FrameWin.h:

2006-10-06  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by Adam, Lou.

        Resizer fixes.
        We now properly invalidate and draw overlapping contents or opaque.

        * platform/win/ScrollViewWin.cpp:
        (WebCore::ScrollView::ScrollViewPrivate::ScrollViewPrivate):
        (WebCore::ScrollView::updateScrollbars):
        (WebCore::ScrollView::resizerOverlapsContent):

2006-10-06  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Adam.

        * plugins/win/PluginDatabaseWin.cpp:
        (WebCore::PluginDatabaseWin::defaultPluginPaths):
        Add (commented out) WMP plugin check.

2006-10-06  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Brady and Geoff.

        <rdar://problems/4769023>
        Crash on cnettv.com - PluginStreamWin::receivedResponse
        
        * platform/win/ResourceLoaderWin.cpp:
        (WebCore::ResourceLoaderWndProc):
        If the Content-Type header is missing, try to figure o ut the content type
        from the file extension. Failing that, just use "application/octet-stream".

2006-10-06  Adam Roben  <aroben@apple.com>

        Reviewed by Maciej.

        Some loader improvements, courtesy of Steve.

        Functionally, the improvements are these:
        1. Support HTTP Authentication
        2. Respect WinInet errors better

        There are also some general code cleanups, like extracting the creation
        of an HTTP request into its own method.

        * platform/win/ResourceLoaderWin.cpp: Add dwError field to
        JobLoadStatus to store WinInet error codes. Also removed the
        globalInternetHandle() function as the global HINTERNET is now only
        needed within startHTTPRequest.
        (WebCore::ResourceLoaderWndProc): Respect error codes and add HTTP
        Authentication support. Also, process HTTP status codes as ints instead
        of strings.
        (WebCore::ResourceLoaderInternal::~ResourceLoaderInternal): Cleanup
        m_formData
        (WebCore::transferJobStatusCallback): Cleanup the code, and set
        dwError.
        (WebCore::ResourceLoader::startHTTPRequest): New method to start a new
        HTTP request.
        (WebCore::ResourceLoader::start): Restructure code.

2006-10-06  Dave Hyatt  <hyatt@apple.com>

        Fix the plugins on cnn.com.  Don't let the scroll view move child plugins around if it hasn't even been parented yet.
        
        Fix an assert in widget destructors caused by not unparenting a ScrollView's scrollbars in its destructor.
        
        * platform/win/ScrollViewWin.cpp:
        (WebCore::ScrollView::ScrollViewPrivate::~ScrollViewPrivate):
        (WebCore::ScrollView::setFrameGeometry):

2006-10-06  Dave Hyatt  <hyatt@apple.com>

        Make sure that plugin windows get properly moved if an ancestor scrollview is shifted without changing its size (meaning
        that layout doesn't get called on the scrollview to update the widget positions).
        
        Fixes the plugins on osnews.com.
        
        * platform/win/ScrollViewWin.cpp:
        (WebCore::ScrollView::setFrameGeometry):

2006-10-05  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by aroben.

        Scrollbars now dodge resizing gripper.

        * bridge/win/FrameViewWin.cpp:
        (WebCore::FrameView::windowResizerRect): added.
        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::windowResizerRect): added.
        * bridge/win/FrameWin.h:
        * platform/win/ScrollViewWin.cpp:
        (WebCore::ScrollView::updateScrollbars): Scrollbars now dodge resizing gripper.

2006-10-05  Dave Hyatt  <hyatt@apple.com>

        Fix a bug where scrollbars would incorrectly show up for iframes when they weren't needed.
        Change the flow of control to be more like Mac.

        * platform/win/ScrollViewWin.cpp:
        (WebCore::ScrollView::resizeContents):
        (WebCore::ScrollView::setFrameGeometry):

2006-10-05  Dave Hyatt  <hyatt@apple.com>

        Fix clipping and transforms by making sure to propagate them as they happen on the CGContext over into the HDC.
        
        * platform/cg/GraphicsContextPlatformPrivate.h:
        * platform/win/GraphicsContextWin.cpp:
        (WebCore::CGContextWithHDC):
        (WebCore::GraphicsContext::getWindowsContext):
        (WebCore::GraphicsContext::releaseWindowsContext):
        (WebCore::GraphicsContextPlatformPrivate::save):
        (WebCore::GraphicsContextPlatformPrivate::restore):
        (WebCore::GraphicsContextPlatformPrivate::clip):
        (WebCore::GraphicsContextPlatformPrivate::scale):
        (WebCore::GraphicsContextPlatformPrivate::rotate):
        (WebCore::GraphicsContextPlatformPrivate::translate):
        (WebCore::GraphicsContextPlatformPrivate::concatCTM):
        * platform/win/TemporaryLinkStubs.cpp:
        (GraphicsContextPlatformPrivate::clip):

2006-10-05  Geoffrey Garen  <ggaren@apple.com>

        build fix.
        
        * platform/win/WidgetWin.cpp:
        (WebCore::Widget::~Widget):
        (WebCore::Widget::setParent):
        (WebCore::Widget::parent):
        (WebCore::Widget::removeFromParent):

2006-10-05  David Hyatt  <hyatt@apple.com>

        Stub out GraphicsContextPlatformPrivate methods so that the HDC can
        be updated when clips/transforms are applied.

        Reviewed by darin

        * platform/cg/GraphicsContextPlatformPrivate.h:
        (WebCore::GraphicsContextPlatformPrivate::save):
        (WebCore::GraphicsContextPlatformPrivate::restore):
        (WebCore::GraphicsContextPlatformPrivate::clip):
        (WebCore::GraphicsContextPlatformPrivate::scale):
        (WebCore::GraphicsContextPlatformPrivate::rotate):
        (WebCore::GraphicsContextPlatformPrivate::translate):
        (WebCore::GraphicsContextPlatformPrivate::concatCTM):

2006-10-05  Adam Roben  <aroben@apple.com>

        Build fix.

        * platform/win/TemporaryLinkStubs.cpp:
        (BrowserExtensionWin::BrowserExtensionWin): Change Frame* to FrameWin*

2006-10-05  Adam Roben  <aroben@apple.com>

        Build fix. Remove RenderImageButton.{h,cpp}.

        * WebCore.vcproj/WebCore.vcproj:

2006-10-05  Geoffrey Garen  <ggaren@apple.com>

        Reviewed by Darin.
        
        Fixed <rdar://problem/4766987>
        
        - renamed ScrollBar to Scrollbar and scroll bar to scrollbar in every case
        except for file names.
        
        - fixed RenderLayer to properly tear down scrollbars, removing them from
        their parents.

        * bridge/win/FrameViewWin.cpp:
        (WebCore::FrameView::passMousePressEventToScrollbar):
        * platform/win/PlatformScrollBar.h:
        (WebCore::):
        * platform/win/PlatformScrollBarWin.cpp:
        (WebCore::PlatformScrollbar::PlatformScrollbar):
        (WebCore::PlatformScrollbar::~PlatformScrollbar):
        (WebCore::PlatformScrollbar::updateThumbPosition):
        (WebCore::PlatformScrollbar::updateThumbProportion):
        (WebCore::PlatformScrollbar::invalidateTrack):
        (WebCore::PlatformScrollbar::invalidatePart):
        (WebCore::PlatformScrollbar::width):
        (WebCore::PlatformScrollbar::height):
        (WebCore::PlatformScrollbar::setRect):
        (WebCore::PlatformScrollbar::setEnabled):
        (WebCore::PlatformScrollbar::paint):
        (WebCore::PlatformScrollbar::backButtonRect):
        (WebCore::PlatformScrollbar::forwardButtonRect):
        (WebCore::PlatformScrollbar::trackRect):
        (WebCore::PlatformScrollbar::thumbRect):
        (WebCore::PlatformScrollbar::gripperRect):
        (WebCore::PlatformScrollbar::splitTrack):
        (WebCore::PlatformScrollbar::thumbPosition):
        (WebCore::PlatformScrollbar::thumbLength):
        (WebCore::PlatformScrollbar::trackLength):
        (WebCore::PlatformScrollbar::paintButton):
        (WebCore::PlatformScrollbar::paintTrack):
        (WebCore::PlatformScrollbar::paintThumb):
        (WebCore::PlatformScrollbar::paintGripper):
        (WebCore::PlatformScrollbar::hitTest):
        (WebCore::PlatformScrollbar::handleMouseMoveEvent):
        (WebCore::PlatformScrollbar::handleMouseOutEvent):
        (WebCore::PlatformScrollbar::handleMousePressEvent):
        (WebCore::PlatformScrollbar::handleMouseReleaseEvent):
        (WebCore::PlatformScrollbar::startTimerIfNeeded):
        (WebCore::PlatformScrollbar::stopTimerIfNeeded):
        (WebCore::PlatformScrollbar::autoscrollPressedPart):
        (WebCore::PlatformScrollbar::autoscrollTimerFired):
        (WebCore::PlatformScrollbar::pressedPartScrollDirection):
        (WebCore::PlatformScrollbar::pressedPartScrollGranularity):
        (WebCore::PlatformScrollbar::thumbUnderMouse):
        (WebCore::PlatformScrollbar::themeChanged):
        (WebCore::PlatformScrollbar::horizontalScrollbarHeight):
        (WebCore::PlatformScrollbar::verticalScrollbarWidth):
        * platform/win/ScrollViewWin.cpp:
        (WebCore::ScrollView::ScrollViewPrivate::ScrollViewPrivate):
        (WebCore::ScrollView::ScrollViewPrivate::setHasHorizontalScrollbar):
        (WebCore::ScrollView::ScrollViewPrivate::setHasVerticalScrollbar):
        (WebCore::ScrollView::ScrollViewPrivate::valueChanged):
        (WebCore::ScrollView::resizeContents):
        (WebCore::ScrollView::scrollBy):
        (WebCore::ScrollView::hScrollbarMode):
        (WebCore::ScrollView::vScrollbarMode):
        (WebCore::ScrollView::suppressScrollbars):
        (WebCore::ScrollView::setHScrollbarMode):
        (WebCore::ScrollView::setVScrollbarMode):
        (WebCore::ScrollView::setScrollbarsMode):
        (WebCore::ScrollView::updateScrollbars):
        (WebCore::ScrollView::scrollbarUnderMouse):
        (WebCore::ScrollView::paint):
        (WebCore::ScrollView::themeChanged):

2006-10-05  Adam Roben  <aroben@apple.com>

        Reviewed by Maciej.

        Fixes <rdar://problem/4757387>
        Unable to sign on to my.yahoo.com

        This patch fixes a number of bugs that all resulted in not being able
        to log on to many websites. The problems were that we weren't allowing
        redirects between HTTP and HTTPS sites and weren't correctly handling
        redirects from POST requests to GET requests.

        * platform/win/ResourceLoaderWin.cpp:
        (WebCore::globalInternetHandle): Move internetHandle and callbackHandle
        into file scope, and add this function to initialize them.
        (WebCore::logLastError): Add this debug logging function to give more
        readable WinInet error messages.
        (WebCore::ResourceLoaderWndProc): The most substantial change here is
        to allow redirects from POST to GET to function correctly. To do this
        we have to create a new HINTERNET for the GET. We also have to be sure
        not to try to read from our now-invalid handles after the redirect.
        (WebCore::transferJobStatusCallback): Rename timerId to jobId, since
        that's what it is.
        (WebCore::ResourceLoader::start): Call new static initializer, and pass
        flags to allow HTTP<->HTTPS redirects. Also change a few delete calls
        to kill().

2006-10-05  Maciej Stachowiak  <mjs@apple.com>

        Reviewed by Adam.

        - changed ResourceLoader to be refcounted

        It keeps a ref on itself while loading as well. This makes
        for a much saner memory management model than the previous.

        In addition, keep it ref'd across all of ResourceLoaderWndProc
        to avoid sending messages to jobs that get deleted partway.

        This fixes <rdar://problem/4766859> Crash in ResourceLoaderWndProc - line 232 at televisionwithoutpity.com, washingtonpost.com

        * platform/win/ResourceLoaderWin.cpp:
        (WebCore::ResourceLoaderWndProc):
        (WebCore::ResourceLoader::start):
        * plugins/win/PluginStreamWin.cpp:
        (WebCore::PluginStreamWin::PluginStreamWin):
        (WebCore::PluginStreamWin::start):
        (WebCore::PluginStreamWin::stop):
        * plugins/win/PluginStreamWin.h:

2006-10-05  Dave Hyatt  <hyatt@apple.com>

        Make key events work with iframes.  Implement scrolling keyboard behavior.  Fix a bug with mouse wheeling that
        made it fail on iframes nested within iframes.
        
        Reviewed by mjs

        * bridge/win/FrameViewWin.cpp:
        (WebCore::FrameView::passWheelEventToSubframe):
        * platform/win/ScrollViewWin.cpp:
        (WebCore::ScrollView::scroll):
        * platform/win/WidgetWin.cpp:
        (WebCore::Widget::Widget):
        (WebCore::Widget::capturingMouse):
        (WebCore::Widget::setCapturingMouse):
        (WebCore::Widget::capturingTarget):
        (WebCore::Widget::setCapturingChild):
        (WebCore::Widget::hasFocus):
        (WebCore::Widget::setFocus):
        (WebCore::Widget::clearFocus):
        (WebCore::Widget::setFocused):
        (WebCore::Widget::focusedTarget):
        (WebCore::Widget::focusedChild):
        (WebCore::Widget::setFocusedChild):
        (WebCore::Widget::clearFocusFromDescendants):

2006-10-05  Adam Roben  <aroben@apple.com>

        Reviewed by Maciej and Tim H.

        Fixes <rdar://problem/4760991>
        Flash content doesn't go away when navigating to a new page

        Actually destroy subframes when detaching.

        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::frameDetached): 
        * bridge/win/FrameWin.h:

2006-10-05  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Maciej.
        
        <rdar://problem/4762998>
        REGRESSION: dragging to select text does not work
        
        * platform/win/PlatformMouseEventWin.cpp:
        (WebCore::PlatformMouseEvent::PlatformMouseEvent):
        Set the correct button for WM_MOUSEMOVE events.

2006-10-05  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Adam.

        rdar://problem/4757081
        Crashes/hangs when using Flash 8 plugin (Flash 9 works MUCH better)
        
        * plugins/win/PluginStreamWin.cpp:
        (WebCore::PluginStreamWin::startStream):
        Encode javascript URLs before passing them to the plugin.

2006-10-05  Darin Adler  <darin@apple.com>

        Reviewed by Adam.

        * platform/win/NotImplemented.h: Changed implementation to use Assertions.h.
        Also fixed both macros to be single-statement macros.

2006-10-05  Darin Adler  <darin@apple.com>

        Reviewed by Adam.

        - fix <rdar://problem/4764253>
          frame targeting not implemented.

        * bridge/win/FrameWin.h: Added new window boolean to openURL. Also changed
        type from DeprecatedString to String.
        * bridge/win/FrameWin.cpp: (WebCore::FrameWin::urlSelected): Added logic
        to do frame targeting.

        * platform/win/BString.h: Added. Convenience for working with
        BSTR and handling allocation/free.
        * platform/win/BString.cpp: Added.
        * WebCore.vcproj/WebCore.vcproj: Added new files.

2006-10-03  Dave Hyatt  <hyatt@apple.com>

        Land the new ScrollView.
        
        Reviewed by anders

        * bridge/win/FrameViewWin.cpp:
        (WebCore::FrameView::passMousePressEventToScrollbar):
        * platform/win/PlatformScrollBar.h:
        * platform/win/PlatformScrollBarWin.cpp:
        (WebCore::PlatformScrollBar::thumbLength):
        (WebCore::PlatformScrollBar::hitTest):
        (WebCore::PlatformScrollBar::horizontalScrollBarHeight):
        (WebCore::PlatformScrollBar::verticalScrollBarWidth):
        * platform/win/ScrollViewWin.cpp:
        (WebCore::ScrollView::ScrollViewPrivate::ScrollViewPrivate):
        (WebCore::ScrollView::ScrollViewPrivate::setHasHorizontalScrollBar):
        (WebCore::ScrollView::ScrollViewPrivate::setHasVerticalScrollBar):
        (WebCore::ScrollView::ScrollViewPrivate::valueChanged):
        (WebCore::ScrollView::ScrollView):
        (WebCore::ScrollView::updateContents):
        (WebCore::ScrollView::visibleWidth):
        (WebCore::ScrollView::visibleHeight):
        (WebCore::ScrollView::visibleContentRect):
        (WebCore::ScrollView::resizeContents):
        (WebCore::ScrollView::contentsWidth):
        (WebCore::ScrollView::contentsHeight):
        (WebCore::ScrollView::windowToContents):
        (WebCore::ScrollView::contentsToWindow):
        (WebCore::ScrollView::convertChildToSelf):
        (WebCore::ScrollView::convertSelfToChild):
        (WebCore::ScrollView::scrollOffset):
        (WebCore::ScrollView::maximumScroll):
        (WebCore::ScrollView::scrollBy):
        (WebCore::ScrollView::scrollPointRecursively):
        (WebCore::ScrollView::hScrollBarMode):
        (WebCore::ScrollView::vScrollBarMode):
        (WebCore::ScrollView::suppressScrollBars):
        (WebCore::ScrollView::setHScrollBarMode):
        (WebCore::ScrollView::setVScrollBarMode):
        (WebCore::ScrollView::setScrollBarsMode):
        (WebCore::ScrollView::setStaticBackground):
        (WebCore::ScrollView::updateScrollBars):
        (WebCore::ScrollView::scrollbarUnderMouse):
        (WebCore::ScrollView::addChild):
        (WebCore::ScrollView::removeChild):
        (WebCore::ScrollView::paint):
        (WebCore::ScrollView::scrolled):
        * platform/win/WidgetWin.cpp:
        (WebCore::Widget::Widget):
        (WebCore::Widget::convertToContainingWindow):
        (WebCore::Widget::convertFromContainingWindow):
        (WebCore::Widget::convertChildToSelf):
        (WebCore::Widget::convertSelfToChild):
        (WebCore::Widget::setSuppressInvalidation):
        (WebCore::Widget::invalidateRect):
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWndProc):
        (WebCore::PluginViewWin::setFrameGeometry):
        (WebCore::PluginViewWin::scrolled):
        * plugins/win/PluginViewWin.h:

2006-10-03  Adam Roben  <aroben@apple.com>

        Reviewed by Steve.

        Improvements to error handling in PluginStreamWin.

        * plugins/win/PluginStreamWin.cpp:
        (WebCore::PluginStreamWin::deliverData): Fail quietly if called after
        termination (due to bad error handling in ResourceLoaderWin), ASSERT if
        called before stream has been started.
        (WebCore::PluginStreamWin::receivedData): Ditto.
        (WebCore::PluginStreamWin::receivedAllData): Ditto.

2006-10-03  Adam Roben  <aroben@apple.com>

        Reviewed by Anders.

        Fixes <rdar://problem/4760963>
        Failed ASSERT in PluginStreamWin::~PluginStreamWin at espn.com

        We now store the state of a stream as a tri-state enum in
        m_streamState. This allows us to differentiate between before and after the
        stream has been started.

        * plugins/win/PluginStreamWin.cpp:
        (WebCore::PluginStreamWin::PluginStreamWin): Initialize members of
        m_stream struct individually.
        (WebCore::PluginStreamWin::~PluginStreamWin):
        (WebCore::PluginStreamWin::startStream):
        (WebCore::PluginStreamWin::destroyStream):
        (WebCore::PluginStreamWin::deliverData): Return early if the stream
        isn't started.
        (WebCore::PluginStreamWin::receivedData): Ditto.
        (WebCore::PluginStreamWin::receivedAllData): Ditto.
        * plugins/win/PluginStreamWin.h:
        (WebCore::): Add PluginStreamState enum.

2006-10-03  Adam Roben  <aroben@apple.com>

        Reviewed by Darin.

        Fixes <rdar://problem/4603342>
        Keyboard navigability

        Implement tabbing between form elements (in the single-frame case).

        * bridge/win/FrameWin.cpp: Add methods to determine tabbing
        preferences.
        (WebCore::FrameWin::tabsToLinks):
        (WebCore::FrameWin::tabsToAllControls):
        * bridge/win/FrameWin.h: Add tabsToLinks() to FrameWinClient
        * platform/win/ScrollViewWin.cpp:
        (WebCore::ScrollView::scrollPointRecursively): Implemented for
        single-frame case.
        * platform/win/TemporaryLinkStubs.cpp: Remove stub for now-implemented
        ScrollView::scrollPointsRecursively

2006-10-02  Adam Roben  <aroben@apple.com>

        Reviewed by Maciej.

        Fixes <rdar://problem/4743497>
        Can't check checkboxes

        Let Windows determine which mouse button is pressed.

        * platform/win/PlatformMouseEventWin.cpp:
        (WebCore::PlatformMouseEvent::PlatformMouseEvent): Use message
        parameter to determine which mouse button is pressed.

2006-10-02  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by Hyatt.

        <rdar://4757387> (partial fix) Unable to sign on to my.yahoo.com
        <rdar://4757405> (partial fix) Unable to log onto secure site (www.schwab.com)
        <rdar://4757411> (partial fix) Unable to log onto any AppleConnect site (but using back and resubmiting works)

        WinInet fixes.
        Don't post data using HTTP when HTTPS should be used.
        Fix redirect from POST to GET case.
        
        There is a remaining bug with the way that we queue WinInet callbacks
        still to be addressed.

        * platform/win/ResourceLoaderWin.cpp:
        (WebCore::addToOutstandingJobs): Skip dwContext of 0 (rollover case).
        (WebCore::ResourceLoaderWndProc): Call default wndproc properly.
            Pass INTERNET_FLAG_SECURE when necessary for HTTPS.
            Fix redirect code.
            Initialize buffers struct.
            Pass proper context in InternetReadFileExA
        (WebCore::initializeOffScreenResourceLoaderWindow): Init a struct to {0} instead of using memset.
        (WebCore::transferJobStatusCallback): Prevent future bugs by making an else a bit more explicit.
        (WebCore::ResourceLoader::start): Pass proper port for HTTP vs. HTTPS.
        (WebCore::ResourceLoader::cancel): Zero out handle when closing.

2006-10-01  Dave Hyatt  <hyatt@apple.com>

        Finish the scrollbar.  Handle arrow and track scrolling.  Everything is finished now except for implementing a Win2k look.

        * platform/win/PlatformScrollBar.h:
        * platform/win/PlatformScrollBarWin.cpp:
        (WebCore::PlatformScrollBar::PlatformScrollBar):
        (WebCore::PlatformScrollBar::~PlatformScrollBar):
        (WebCore::PlatformScrollBar::thumbRect):
        (WebCore::PlatformScrollBar::handleMouseMoveEvent):
        (WebCore::PlatformScrollBar::handleMousePressEvent):
        (WebCore::PlatformScrollBar::handleMouseReleaseEvent):
        (WebCore::PlatformScrollBar::startTimerIfNeeded):
        (WebCore::PlatformScrollBar::stopTimerIfNeeded):
        (WebCore::PlatformScrollBar::autoscrollPressedPart):
        (WebCore::PlatformScrollBar::autoscrollTimerFired):
        (WebCore::PlatformScrollBar::pressedPartScrollDirection):
        (WebCore::PlatformScrollBar::pressedPartScrollGranularity):
        (WebCore::PlatformScrollBar::thumbUnderMouse):

2006-10-01  Dave Hyatt  <hyatt@apple.com>
        
        Make thumb dragging work on the scrollbar.
        
        Fix mouse and wheel events to use GET_X_LPARAM and GET_Y_LPARAM so that negative coordinates work.
        (This comes up when a widget is capturing events and the mouse moves outside the HWND.)
        
        * platform/win/PlatformMouseEventWin.cpp:
        (WebCore::positionForEvent):
        (WebCore::globalPositionForEvent):
        * platform/win/PlatformScrollBar.h:
        * platform/win/PlatformScrollBarWin.cpp:
        (WebCore::PlatformScrollBar::PlatformScrollBar):
        (WebCore::PlatformScrollBar::handleMouseMoveEvent):
        (WebCore::PlatformScrollBar::handleMousePressEvent):
        (WebCore::PlatformScrollBar::handleMouseReleaseEvent):
        (WebCore::PlatformScrollBar::startTimerIfNeeded):
        (WebCore::PlatformScrollBar::stopTimerIfNeeded):
        * platform/win/WheelEventWin.cpp:
        (WebCore::positionForEvent):
        (WebCore::globalPositionForEvent):

2006-10-01  Dave Hyatt  <hyatt@apple.com>

        Hook up the mouse capture architecture so that child widgets capture events while the mouse is pressed.
        
        Hook up tracking the pressed object on a scrollbar and proper painting of the scrollbar's
        pressed state.
        
        * bridge/win/FrameViewWin.cpp:
        (WebCore::FrameView::passMousePressEventToSubframe):
        (WebCore::FrameView::passMousePressEventToScrollbar):
        * platform/win/PlatformScrollBar.h:
        * platform/win/PlatformScrollBarWin.cpp:
        (WebCore::PlatformScrollBar::PlatformScrollBar):
        (WebCore::PlatformScrollBar::paintButton):
        (WebCore::PlatformScrollBar::paintTrack):
        (WebCore::PlatformScrollBar::paintThumb):
        (WebCore::PlatformScrollBar::paintGripper):
        (WebCore::PlatformScrollBar::handleMouseMoveEvent):
        (WebCore::PlatformScrollBar::handleMousePressEvent):
        (WebCore::PlatformScrollBar::handleMouseReleaseEvent):
        * platform/win/WidgetWin.cpp:
        (WebCore::Widget::setCapturingChild):

2006-09-30  Dave Hyatt  <hyatt@apple.com>

        This patch makes iframes and frames able to receive mouse events.  Down, up, click, selection
        all work.  This patch also fixes bugs in scrolling and makes wheel events work on iframes.
        A capturing system for routing events to the proper subwidget when the mouse has down
        is also stubbed out (but not yet used).
        
        Reviewed by andersca

        * WebCore.vcproj/WebCore.vcproj:
        * bridge/win/FrameViewWin.cpp: Added.
        (WebCore::FrameView::passMousePressEventToSubframe):
        (WebCore::FrameView::passMouseMoveEventToSubframe):
        (WebCore::FrameView::passMouseReleaseEventToSubframe):
        (WebCore::FrameView::passWheelEventToSubframe):
        * bridge/win/FrameWin.cpp:
        * bridge/win/FrameWin.h:
        * platform/win/PlatformScrollBar.h:
        * platform/win/PlatformScrollBarWin.cpp:
        (WebCore::PlatformScrollBar::handleMouseMoveEvent):
        (WebCore::PlatformScrollBar::handleMouseOutEvent):
        (WebCore::PlatformScrollBar::handleMouseReleaseEvent):
        * platform/win/ScrollViewWin.cpp:
        (WebCore::ScrollView::visibleContentRect):
        (WebCore::ScrollView::scrollBy):
        (WebCore::ScrollView::removeChild):
        * platform/win/TemporaryLinkStubs.cpp:
        (FrameWin::print):
        (FrameWin::lastEventIsMouseUp):
        * platform/win/WidgetWin.cpp:
        (WebCore::Widget::Widget):
        (WebCore::Widget::capturingMouse):
        (WebCore::Widget::setCapturingMouse):
        (WebCore::Widget::capturingTarget):
        (WebCore::Widget::capturingChild):
        (WebCore::Widget::setCapturingChild):

2006-09-29  Steve Falkenburg  <sfalken@apple.com>

        Fix the build.

        * platform/win/PlatformScrollBarWin.cpp:

2006-09-29  Adele Peterson  <adele@apple.com>

        Adding RenderListBox files.

        * WebCore.vcproj/WebCore.vcproj:

2006-09-29  Adele Peterson  <adele@apple.com>

        Reviewed by Adam.

        Updated constructor for PlatformScrollBar to include controlSize argument.

        * platform/win/PlatformScrollBar.h:
        * platform/win/PlatformScrollBarWin.cpp:
        (WebCore::PlatformScrollBar::PlatformScrollBar):

2006-09-29  Adam Roben  <aroben@apple.com>

        Reviewed by hyatt.

        Add error logging to plugin code.

        * WebCore.vcproj/WebCore.vcproj: Added PluginDebug.h
        * platform/win/NotImplemented.h: Add surrounding #ifndef/#endif
        * plugins/win/PluginDebug.h: Added.
        * plugins/win/PluginPackageWin.cpp: Add error logging
        (WebCore::PluginPackageWin::load):
        * plugins/win/PluginStreamWin.cpp: Ditto.
        (WebCore::PluginStreamWin::startStream):
        (WebCore::PluginStreamWin::destroyStream):
        (WebCore::PluginStreamWin::deliverData):
        (WebCore::PluginStreamWin::receivedAllData):
        * plugins/win/PluginViewWin.cpp: Ditto.
        (WebCore::PluginViewWin::start):
        (WebCore::PluginViewWin::stop):
        (WebCore::PluginViewWin::newStream):
        (WebCore::PluginViewWin::write):
        (WebCore::PluginViewWin::destroyStream):

2006-09-29  Dave Hyatt  <hyatt@apple.com>

        Fork MouseEventWin.cpp into (the better-named) PlatformMouseEventWin.cpp.
        
        * WebCore.vcproj/WebCore.vcproj:
        * platform/win/PlatformMouseEventWin.cpp: Added.

2006-09-28  Dave Hyatt  <hyatt@apple.com>

        Make scrollbars scroll correctly when setValue is called.  Needed to do float math instead of integer
        math (and also fix some buggy math when computing the thumb position).
 
        * platform/win/PlatformScrollBarWin.cpp:
        (WebCore::PlatformScrollBar::thumbPosition):

2006-09-28  Dave Hyatt  <hyatt@apple.com>

        Make scrollbars on Win32 respond to hover events.  The thumb and arrow buttons will now properly hover when
        the mouse enters and exits them.
        
        * platform/win/PlatformScrollBar.h:
        * platform/win/PlatformScrollBarWin.cpp:
        (WebCore::PlatformScrollBar::invalidatePart):
        (WebCore::PlatformScrollBar::paintButton):
        (WebCore::PlatformScrollBar::paintTrack):
        (WebCore::PlatformScrollBar::paintThumb):
        (WebCore::PlatformScrollBar::paintGripper):
        (WebCore::PlatformScrollBar::hitTest):
        (WebCore::PlatformScrollBar::mouseMoved):
        (WebCore::PlatformScrollBar::mouseExited):

2006-09-28  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by Maciej.

        Use $(ConfigSuffix) set via vsprops files to add _debug
        to end of debug filenames.

        Update B&I build script.

        * WebCore.vcproj/WebCore.make:
        * WebCore.vcproj/WebCore.vcproj:
        * WebCore.vcproj/debug.vsprops: Added.
        * WebCore.vcproj/release.vsprops: Added.

2006-09-28  Adam Roben  <aroben@apple.com>

        Reviewed by Hyatt.

        Avoid creating LOGFONTs for bitmap fonts under CG, since we don't
        support them anyway.

        * platform/win/FontCacheWin.cpp:
        (WebCore::FontCache::createFontPlatformData): Set lfOutPrecision to
        OUT_TT_ONLY_PRECIS to avoid bitmap fonts.
        * platform/win/FontPlatformDataWin.cpp:
        (WebCore::FontPlatformData::FontPlatformData): Change the LOG_ERROR
        back to an ASSERT since we should never reach this condition now.

2006-09-28  Dave Hyatt  <hyatt@apple.com>

        This patch eliminates viewportToContents/contentsToViewport in favor of convertTo/FromContainingWindow.
        ScrollView now subclasses these methods to factor in its scrollOffset and to deal with the document
        view.
       
        Reviewed by mjs (the convertTo/From changes), (I added the elimination of viewportToContents to
        the patch after review, once I realized that these new functions essentially do the same thing.)

        * platform/win/ScrollViewWin.cpp:
        (WebCore::ScrollView::updateContents):
        (WebCore::ScrollView::convertToContainingWindow):
        (WebCore::ScrollView::convertFromContainingWindow):
        (WebCore::ScrollView::scrollBy):
        * platform/win/WidgetWin.cpp:
        (WebCore::Widget::convertToContainingWindow):
        (WebCore::Widget::convertFromContainingWindow):

2006-09-28  Adam Roben  <aroben@apple.com>

        Reviewed by Anders.

        Fail without crashing and log an error when CG encounters a bitmap
        font.

        * platform/win/FontPlatformDataWin.cpp:
        (WebCore::FontPlatformData::FontPlatformData): Trade LOG_ERROR for
        ASSERT_WITH_MESSAGE

2006-09-27  Alice Liu  <alice.liu@apple.com>

        Reviewed by Steve & Adam.

        * WebCore.vcproj/WebCore.vcproj:
        Added files to the project file
        * platform/win/TemporaryLinkStubs.cpp:
        Removed stub for findWordBoundary
        * platform/win/TextBoundariesWin.cpp: Added.
        Implemented cross-platform findWordBoundary.  We're still keeping the mac one intact for now. 
        (WebCore::findWordBoundary):

2006-09-28  Adam Roben  <aroben@apple.com>

        Reviewed by Adele.

        Remove never-to-be-used PopUpButton

        * WebCore.vcproj/WebCore.vcproj: Remove PopUpButton.h
        * platform/win/TemporaryLinkStubs.cpp: Remove PopUpButton:: methods

2006-09-28  Adam Roben  <aroben@apple.com>

        Reviewed by Alice.

        Replace notImplemented() with LOG_NOIMPL() and STOP_NOIMPL() macros
        which generate debug output. STOP_NOIMPL() also generates a debug
        break. Replace calls to notImplemented() with
        LOG_NOIMPL()/STOP_NOIMPL() as appropriate. This should stop some unnecessary
        crashes where notImplemented() was called from a method that can fail
        safely.

        * WebCore.vcproj/WebCore.vcproj: Added NotImplemented.h
        * platform/win/FontWin.cpp: Use LOG_NOIMPL() instead of notImplemented().
        (WebCore::Font::selectionRectForComplexText):
        (WebCore::Font::drawComplexText):
        (WebCore::Font::floatWidthForComplexText):
        (WebCore::Font::offsetForPositionForComplexText):
        * platform/win/NotImplemented.h: Added. Contains new LOG_NOIMPL() and
        STOP_NOIMPL() macros.
        * platform/win/TemporaryLinkStubs.cpp: Use LOG_NOIMPL() and
        STOP_NOIMPL() instead of notImplemented() or nothing.
        (PopUpButton::focusPolicy):
        (PopUpButton::populate):
        (Widget::enableFlushDrawing):
        (Widget::focusPolicy):
        (Widget::disableFlushDrawing):
        (Widget::lockDrawingFocus):
        (Widget::unlockDrawingFocus):
        (JavaAppletWidget::JavaAppletWidget):
        (TextField::selectAll):
        (TextField::addSearchResult):
        (TextField::selectionStart):
        (TextField::hasSelectedText):
        (TextField::selectedText):
        (TextField::setAutoSaveName):
        (TextField::checksDescendantsForFocus):
        (TextField::setSelection):
        (TextField::setMaxResults):
        (TextField::edited):
        (Slider::Slider):
        (Slider::sizeHint):
        (Slider::setValue):
        (Slider::setMaxValue):
        (Slider::setMinValue):
        (Slider::~Slider):
        (Slider::setFont):
        (Slider::value):
        (ListBox::sizeForNumberOfLines):
        (ListBox::isSelected):
        (ListBox::checksDescendantsForFocus):
        (Slider::focusPolicy):
        (ListBox::focusPolicy):
        (TextField::focusPolicy):
        (Cursor::Cursor):
        (PlatformMouseEvent::PlatformMouseEvent):
        (WebCore::searchableIndexIntroduction):
        (WebCore::findNextSentenceFromIndex):
        (WebCore::findSentenceBoundary):
        (WebCore::findNextWordFromIndex):
        (WebCore::ServeSynchronousRequest):
        (FrameWin::focusWindow):
        (FrameWin::unfocusWindow):
        (FrameWin::locationbarVisible):
        (FrameWin::registerCommandForRedo):
        (FrameWin::getObjectInstanceForWidget):
        (FrameWin::getEmbedInstanceForWidget):
        (FrameWin::getAppletInstanceForWidget):
        (FrameWin::canRedo):
        (FrameWin::canUndo):
        (FrameWin::canPaste):
        (FrameWin::canGoBackOrForward):
        (FrameWin::shouldInterruptJavaScript):
        (FrameWin::openURL):
        (FrameWin::print):
        (FrameWin::passMouseDownEventToWidget):
        (FrameWin::issueCutCommand):
        (FrameWin::issueCopyCommand):
        (FrameWin::issuePasteCommand):
        (FrameWin::issueUndoCommand):
        (FrameWin::issueRedoCommand):
        (FrameWin::issuePasteAndMatchStyleCommand):
        (FrameWin::issueTransposeCommand):
        (FrameWin::passWheelEventToChildWidget):
        (FrameWin::mimeTypeForFileName):
        (FrameWin::scheduleClose):
        (FrameWin::markMisspellings):
        (FrameWin::menubarVisible):
        (FrameWin::personalbarVisible):
        (FrameWin::statusbarVisible):
        (FrameWin::toolbarVisible):
        (FrameWin::originalRequestURL):
        (FrameWin::isLoadTypeReload):
        (BrowserExtensionWin::canRunModal):
        (BrowserExtensionWin::createNewWindow):
        (BrowserExtensionWin::canRunModalNow):
        (BrowserExtensionWin::runModal):
        (BrowserExtensionWin::goBackOrForward):
        (BrowserExtensionWin::historyURL):
        (GraphicsContext::addRoundedRectClip):
        (GraphicsContext::addInnerRoundedRectClip):
        (WebCore::screenDepthPerComponent):
        (WebCore::screenIsMonochrome):
        (WebCore::moveCursor):
        (WebCore::inputElementAltText):
        (WebCore::findWordBoundary):
        (WebCore::ResourceLoader::assembleResponseHeaders):
        (WebCore::ResourceLoader::retrieveCharset):
        (FrameView::updateBorder):
        (FrameWin::restoreDocumentState):
        (FrameWin::partClearedInBegin):
        (FrameWin::createEmptyDocument):
        (FrameWin::overrideMediaType):
        (FrameWin::markedTextRange):
        (FrameWin::addMessageToConsole):
        (FrameWin::shouldChangeSelection):
        (FrameWin::respondToChangedSelection):
        (FrameWin::saveDocumentState):
        (FrameWin::registerCommandForUndo):
        (FrameWin::clearUndoRedoOperations):
        (FrameWin::incomingReferrer):
        (FrameWin::markMisspellingsInAdjacentWords):
        (FrameWin::respondToChangedContents):
        (BrowserExtensionWin::BrowserExtensionWin):
        (BrowserExtensionWin::setTypedIconURL):
        (BrowserExtensionWin::setIconURL):
        (BrowserExtensionWin::getHistoryLength):
        (WebCore::CheckIfReloading):
        (WebCore::CheckCacheObjectStatus):
        (Widget::setIsSelected):
        (ScrollView::inWindow):
        (ScrollView::scrollPointRecursively):
        (GraphicsContext::setShadow):
        (GraphicsContext::clearShadow):
        (GraphicsContext::beginTransparencyLayer):
        (GraphicsContext::endTransparencyLayer):
        (GraphicsContext::clearRect):
        (GraphicsContext::strokeRect):
        (GraphicsContext::setLineWidth):
        (GraphicsContext::setLineCap):
        (GraphicsContext::setLineJoin):
        (GraphicsContext::setMiterLimit):
        (GraphicsContext::setAlpha):
        (GraphicsContext::clip):
        (GraphicsContext::rotate):
        (GraphicsContext::scale):
        (Path::Path):
        (Path::~Path):
        (Path::contains):
        (Path::translate):
        (Path::boundingRect):
        (Path::operator=):
        (Path::clear):
        (Path::moveTo):
        (Path::addLineTo):
        (Path::addQuadCurveTo):
        (Path::addBezierCurveTo):
        (Path::addArcTo):
        (Path::closeSubpath):
        (Path::addArc):
        (Path::addRect):
        (Path::addEllipse):
        (GraphicsContext::drawFocusRing):
        (GraphicsContext::drawLineForMisspelling):
        (GraphicsContext::setCompositeOperation):
        (TextField::TextField):
        (TextField::~TextField):
        (TextField::setFont):
        (TextField::setAlignment):
        (TextField::setWritingDirection):
        (TextField::maxLength):
        (TextField::setMaxLength):
        (TextField::text):
        (TextField::setText):
        (TextField::cursorPosition):
        (TextField::setCursorPosition):
        (TextField::setEdited):
        (TextField::setReadOnly):
        (TextField::setPlaceholderString):
        (TextField::setColors):
        (TextField::sizeForCharacterWidth):
        (TextField::baselinePosition):
        (TextField::setLiveSearch):
        (PopUpButton::PopUpButton):
        (PopUpButton::~PopUpButton):
        (PopUpButton::setFont):
        (PopUpButton::baselinePosition):
        (PopUpButton::setWritingDirection):
        (PopUpButton::clear):
        (PopUpButton::appendItem):
        (PopUpButton::setCurrentItem):
        (PopUpButton::sizeHint):
        (PopUpButton::frameGeometry):
        (PopUpButton::setFrameGeometry):
        (ListBox::ListBox):
        (ListBox::~ListBox):
        (ListBox::setSelectionMode):
        (ListBox::setFont):
        (ListBox::setWritingDirection):
        (ListBox::clear):
        (ListBox::doneAppendingItems):
        (ListBox::setEnabled):
        (ListBox::appendItem):
        (ListBox::setSelected):
        (WebCore::focusRingColor):
        (WebCore::setFocusRingColorChangeFunction):
        (Frame::setNeedsReapplyStyles):
        (Image::drawTiled):
        (RenderPopupMenuWin::addSeparator):
        (RenderPopupMenuWin::addGroupLabel):
        (IconLoader::receivedResponse):
        (IconLoader::notifyIconChanged):
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::setValue):

2006-09-28  Adam Roben  <aroben@apple.com>

        Rubberstamped by sfalken.

        Remove calls to DebugBreak() from plugin code.

        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::getValue):
        (WebCore::PluginViewWin::setValue):

2006-09-28  Dave Hyatt  <hyatt@apple.com>

        Eliminate the use of MapWindowPoints on Win32. Just use the outermost HWND as the point of reference for events.  
        
        Stub out the mouse methods from the open source checkin and add a new member variable to track the current hovered scrollbar part.

        * platform/win/PlatformScrollBar.h:
        (WebCore::):
        * platform/win/PlatformScrollBarWin.cpp:
        (WebCore::PlatformScrollBar::PlatformScrollBar):
        (WebCore::PlatformScrollBar::mouseMoved):
        (WebCore::PlatformScrollBar::mouseExited):
        * platform/win/ScrollViewWin.cpp:
        (WebCore::ScrollView::viewportToContents):
        (WebCore::ScrollView::contentsToViewport):
        * platform/win/WheelEventWin.cpp:
        (WebCore::positionForEvent):

2006-09-27  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by Maciej.

        Leave ChickenCat SDK untouched by build.
        
        This change will become necessary once we have JavaScriptCore,
        WebCore, WebKit, and SafariWin in the ChickenCat SDK.
        
        Prefer pulling project dependencies from WebKitOutputDir over
        WebKitSDKDir.  Don't copy build output back over to WebKitSDKDir.

        * WebCore.vcproj/WebCore.vcproj:
        * WebCore.vcproj/build-generated-files.sh:
        * WebCore.vcproj/dstroot-to-sdk.cmd: Removed.

2006-09-27  Steve Falkenburg  <sfalken@apple.com>

        B&I build fixes

        * WebCore.vcproj/WebCore.make:
        * WebCore.vcproj/WebCore.vcproj:
        * WebCore.vcproj/build-generated-files.sh:

2006-09-27  Adam Roben  <aroben@apple.com>

        Reviewed by sfalken.

        Don't die when plugins try to open a new window.

        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::performRequest): Remove call to DebugBreak()

2006-09-27  Steve Falkenburg  <sfalken@apple.com>

        B&I build script tweaks.

        * WebCore.vcproj/WebCore.make:

2006-09-27  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by Hyatt.

        Turn on CG

        * config.h:

2006-09-27  Adam Roben  <aroben@apple.com>

        Reviewed by Lou.

        Fix crash in plugins due to Flash on nytimes.com

        * plugins/win/PluginStreamWin.cpp:
        (WebCore::PluginStreamWin::PluginStreamWin): memset m_stream to 0

2006-09-27  Adam Roben  <aroben@apple.com>

        Reviewed by sfalken.

        Scroll plugins (at least in some cases).

        * platform/win/ScrollViewWin.cpp:
        (WebCore::ScrollView::scrollBy): Pass SW_SCROLLCHILDREN to ScrollWindowEx()

2006-09-27  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by Adam.

        Remove unimplemented from a temporary link stub.

        * platform/win/TemporaryLinkStubs.cpp:
        (GraphicsContext::addInnerRoundedRectClip):

2006-09-27  Sean Gies  <seangies@apple.com>

        Reviewed by Brady Eidson.

        * WebCore.vcproj/WebCore.vcproj: Added platform/win/WebCoreSystemInterface.h/cpp
        * platform/win/WebCoreSystemInterface.cpp: Added.
        * platform/win/WebCoreSystemInterface.h: Added.

2006-09-26  Adam Roben  <aroben@apple.com>

        Reviewed by sfalken.

        Fixes <rdar://problem/4751600>
        Hang on Amazon.com involving Flash

        * plugins/win/PluginStreamWin.cpp: Rename m_streamStarted to
        m_isTerminated to match Mac code (m_isTerminated is the negation of
        m_streamStarted)
        (WebCore::PluginStreamWin::PluginStreamWin): Initialize m_isTerminated
        to false to match Mac code.
        (WebCore::PluginStreamWin::~PluginStreamWin): Rename and negate.
        (WebCore::PluginStreamWin::stop): Remove assignment of m_streamStarted
        to match Mac code.
        (WebCore::PluginStreamWin::startStream): Rename and negate. Remove
        now-unnecessary assignment of m_streamStarted to true because we set
        m_isTerminated to false in the constructor.
        (WebCore::PluginStreamWin::destroyStream): Rename and negate.
        * plugins/win/PluginStreamWin.h: Rename m_streamStarted to
        m_isTerminated.
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::performRequest): Send the correct response URL
        to the plugin.

2006-09-26  Steve Falkenburg  <sfalken@apple.com>

        More temporary link stubs moved.
        Build tweaks.

        * ChangeLog:
        * WebCore.vcproj/WebCore.make: Added.
        * WebCore.vcproj/WebCore.vcproj:
        * platform/win/TemporaryLinkStubs.cpp:
        (ListBox::isSelected):
        (ListBox::setWritingDirection):
        (ListBox::clear):
        (ListBox::doneAppendingItems):
        (ListBox::setEnabled):
        (ListBox::appendItem):
        (ListBox::setSelected):

2006-09-26  Sean Gies  <seangies@apple.com>

        Reviewed by Brady Eidson.

        * platform/win/GraphicsContextWin.cpp:
        (WebCore::CGContextWithHDC):  Make a static function.
        (WebCore::GraphicsContext::getWindowsContext): Assume flipped coordinates.

2006-09-26  Brady Eidson  <beidson@apple.com>

        Nuked another notImplemented() that is getting hit

        * platform/win/TemporaryLinkStubs.cpp:
        (GraphicsContext::addRoundedRectClip):

2006-09-26  Sean Gies  <seangies@apple.com>

        Reviewed by Adam Roben.

        * WebCore.vcproj/WebCore.vcproj: Use Debug DLL C runtime for debug config.

2006-09-26  Lou Amadio  <lamadio@apple.com>

        Reviewed by ggaren
        Uninitialized variable caused a memory corruption on cnn.com

        WARNING: NO TEST CASES ADDED OR CHANGED

        * plugins/win/PlugInInfoStoreWin.cpp:
        (WebCore::PlugInInfoStore::createPluginInfoForPluginAtIndex):

2006-09-26  Dave Hyatt  <hyatt@apple.com>

        Fix my buggy invalidateRect implementation for Win32 widgets.
        
        Clean up my rect computation code in scrollbar to use x() and y() instead of
        frameGeometry().x()/y().
        
        Add a new invalidateTrack() method that invalidates the track (and handles
        putting the rect into the right coordinate space for proper invalidation
        now that I fixed invalidateRect).

        * platform/win/PlatformScrollBar.h:
        * platform/win/PlatformScrollBarWin.cpp:
        (WebCore::PlatformScrollBar::updateThumbPosition):
        (WebCore::PlatformScrollBar::updateThumbProportion):
        (WebCore::PlatformScrollBar::invalidateTrack):
        (WebCore::PlatformScrollBar::backButtonRect):
        (WebCore::PlatformScrollBar::forwardButtonRect):
        (WebCore::PlatformScrollBar::trackRect):
        * platform/win/WidgetWin.cpp:
        (WebCore::Widget::invalidate):

2006-09-26  Dave Hyatt  <hyatt@apple.com>

        Teach all our Win32 theme code (RenderTheme and PlatformScrollBar) how to respond correctly to OS theme changes.
        
        Implement painting of scrollbars using theme APIs.  The arrow buttons, track, thumb and gripper all paint properly
        now.  Next up is hit testing and proper hover feedback.
        
        Reviewed by andersca
        
        * platform/win/PlatformScrollBar.h:
        * platform/win/PlatformScrollBarWin.cpp:
        (WebCore::PlatformScrollBar::PlatformScrollBar):
        (WebCore::PlatformScrollBar::paint):
        (WebCore::PlatformScrollBar::backButtonRect):
        (WebCore::PlatformScrollBar::forwardButtonRect):
        (WebCore::PlatformScrollBar::trackRect):
        (WebCore::PlatformScrollBar::gripperRect):
        (WebCore::PlatformScrollBar::splitTrack):
        (WebCore::PlatformScrollBar::thumbPosition):
        (WebCore::PlatformScrollBar::thumbLength):
        (WebCore::PlatformScrollBar::paintButton):
        (WebCore::PlatformScrollBar::paintTrack):
        (WebCore::PlatformScrollBar::paintThumb):
        (WebCore::PlatformScrollBar::paintGripper):
        (WebCore::PlatformScrollBar::themeChanged):
        * platform/win/ScrollViewWin.cpp:
        (WebCore::ScrollView::themeChanged):
        * platform/win/TemporaryLinkStubs.cpp:
        (Widget::enableFlushDrawing):
        * platform/win/WidgetWin.cpp:
        (WebCore::Widget::isEnabled):
        * rendering/RenderThemeWin.cpp:
        (WebCore::RenderThemeWin::RenderThemeWin):
        (WebCore::RenderThemeWin::openButtonTheme):
        (WebCore::RenderThemeWin::openTextFieldTheme):
        (WebCore::RenderThemeWin::openMenuListTheme):
        (WebCore::RenderThemeWin::close):
        (WebCore::RenderThemeWin::themeChanged):
        * rendering/RenderThemeWin.h:

2006-09-25  Adam Roben  <aroben@apple.com>

        Rubberstamped by sfalken.

        Set svn:eol-style to native and cleanup line endings on plugins files.

        * plugins/win/PluginStreamWin.cpp:
        (WebCore::PluginStreamWin::PluginStreamWin):
        (WebCore::PluginStreamWin::~PluginStreamWin):
        (WebCore::PluginStreamWin::start):
        (WebCore::PluginStreamWin::startStream):
        (WebCore::PluginStreamWin::destroyStream):
        (WebCore::PluginStreamWin::deliverData):
        (WebCore::PluginStreamWin::receivedResponse):
        (WebCore::PluginStreamWin::receivedData):
        (WebCore::PluginStreamWin::receivedAllData):

2006-09-25  Adam Roben  <aroben@apple.com>

        Reviewed by Brady.

        Fixes <rdar://problem/4749494>
        Crash/ASSERT in plugins at Fark.com

        * platform/win/ResourceLoaderWin.cpp: Store whether a particular job
        has received a response within the ResourceLoader object itself, since
        it's possible that we will enter the InternetReadFileExA while loop
        twice for the same job.
        (WebCore::ResourceLoaderWndProc): Ask the job whether it has received a
        response instead of assuming it hasn't.
        (WebCore::ResourceLoader::setHasReceivedResponse): Added.
        (WebCore::ResourceLoader::hasReceivedResponse): Added.

2006-09-25  Adam Roben  <aroben@apple.com>

        Rubberstamped by sfalken.

        Continuing the removal of unnecessary notImplemented() calls.

        * platform/win/TemporaryLinkStubs.cpp:
        (PlatformMouseEvent::PlatformMouseEvent):
        (FrameWin::passWheelEventToChildWidget):

2006-09-25  Adam Roben  <aroben@apple.com>

        Rubberstamped by sfalken.

        More notImplemented()-ectomy.

        * platform/win/TemporaryLinkStubs.cpp:
        (RenderPopupMenuWin::addSeparator):
        (RenderPopupMenuWin::addGroupLabel):

2006-09-25  Adam Roben  <aroben@apple.com>

        Rubberstamped by sfalken.

        Remove calls to notImplemented() from functions that can fail safely.

        * platform/win/TemporaryLinkStubs.cpp:
        (FrameWin::originalRequestURL):
        (FrameWin::isLoadTypeReload):
        (IconLoader::receivedResponse):
        (IconLoader::notifyIconChanged):

2006-09-25  Adam Roben  <aroben@apple.com>

        Rubberstamped by sfalken.

        Make notImplemented() crash even when not linked against the debug CRT.

        * platform/win/TemporaryLinkStubs.cpp:
        (notImplemented): Change _CrtDbgBreak() to ASSERT(0)

2006-09-24  Dave Hyatt  <hyatt@apple.com>

        Update the scrollbar API to match the changes in the public tree.
        
        Start implementing the Win32 scrollbar.  Add some scaffolding for grabbing uxtheme.dll info and also
        add some utility functions for breaking the scrollbar into individual components.
        
        * platform/win/PlatformScrollBar.h:
        * platform/win/PlatformScrollBarWin.cpp:
        (WebCore::PlatformScrollBar::PlatformScrollBar):
        (WebCore::PlatformScrollBar::updateThumbPosition):
        (WebCore::PlatformScrollBar::updateThumbProportion):
        (WebCore::PlatformScrollBar::paint):
        (WebCore::PlatformScrollBar::backButtonRect):
        (WebCore::PlatformScrollBar::forwardButtonRect):
        (WebCore::PlatformScrollBar::trackRect):
        (WebCore::PlatformScrollBar::splitTrack):

2006-09-22  Steve Falkenburg  <sfalken@apple.com>

        Fix release build some more.

        * WebCore.vcproj/WebCore.vcproj:

2006-09-22  Brady Eidson  <beidson@apple.com>

        Extremely urgent update to my last two patches (without it, many urls will fail to load)

        * platform/win/ResourceLoaderWin.cpp:
        (WebCore::ResourceLoader::onRequestComplete):

2006-09-22  Brady Eidson  <beidson@apple.com>

        Forgot some lines we needed to keep for the internal build in my last checkin

        * platform/win/ResourceLoaderWin.cpp:

2006-09-22  Brady Eidson  <beidson@apple.com>

        Reviewed by Steve

        Landed from OpenSource - that version now supports Redirect like we need, and is a little cleaner design

        * platform/win/ResourceLoaderWin.cpp:
        (WebCore::):
        (WebCore::ResourceLoaderWndProc):
        (WebCore::initializeOffScreenResourceLoaderWindow):
        (WebCore::ResourceLoaderInternal::~ResourceLoaderInternal):
        (WebCore::ResourceLoader::onHandleCreated):
        (WebCore::ResourceLoader::onRequestRedirected):
        (WebCore::ResourceLoader::onRequestComplete):
        (WebCore::transferJobStatusCallback):
        (WebCore::ResourceLoader::start):
        (WebCore::ResourceLoader::fileLoadTimer):
        (WebCore::ResourceLoader::cancel):

2006-09-22  Dave Hyatt <hyatt@apple.com>

        Implement support for CSS2 system fonts on Win32.  Implement support for our special control font so that controls now
        pick up the correct font from the system.  This fixes the crazy form control font sizes on e.g., www.google.com.

        * platform/win/TemporaryLinkStubs.cpp:
        * rendering/RenderThemeWin.cpp:
        (WebCore::fillFontDescription):
        (WebCore::RenderThemeWin::systemFont):

2006-09-22  Dave Hyatt <hyatt@apple.com>

        Scrollbar preparation work.
        
        (1) Add support for enabling/disabling widgets.
        (2) Add support for invalidation of part or all of a widget.
        (3) Clean up some of the Win32 scrollbar code.  All that's left is painting
        and event handling. (Oh, is that all...) :)

        Reviewed by anders

        * platform/win/PlatformScrollBarWin.cpp:
        (WebCore::PlatformScrollBar::setScrollBarValue):
        (WebCore::PlatformScrollBar::setKnobProportion):
        (WebCore::PlatformScrollBar::setEnabled):
        (WebCore::PlatformScrollBar::paint):
        * platform/win/TemporaryLinkStubs.cpp:
        * platform/win/WidgetWin.cpp:
        (WebCore::Widget::Widget):
        (WebCore::Widget::setEnabled):
        (WebCore::Widget::invalidate):
        (WebCore::Widget::invalidateRect):

2006-09-21  Brady Eidson <beidson@apple.com>

        Build was broken for at least some, and I think my checkin that messed with 
        #include orders was to blame (and it was messy, broken or not) - this cleans that up

        * platform/win/ResourceLoaderWin.cpp:

2006-09-21  Alice Liu  <alice.liu@apple.com>

        Reviewed by Hyatt.

        windows build fix

        * platform/win/GraphicsContextWin.cpp:
        wrapped a CG #include in #if PLATFORM(CG)

2006-09-21  Geoffrey Garen  <ggaren@apple.com>

        Reviewed by Maciej, Hyatt, Steve.
    
        frames!
        
        Prep work:
            - moved ScrollViewWin into OpenSourceWin
            - set eol-style:native on some files and corrected line endings
            - updated the WebCore project so that you don't need cygwin in your Windows path
              to build correctly.

        Real work:

            On Windows, Widgets are no longer interfaces to Windows UI tookit objects. They're 
            just positioned objects.
                
            Widgets position themselves relative to their parents. The top-level widget technically
            has a position relative to the WebView, but that's academic, since it's always (0, 0).
            All widgets draw inside a common containing window (the WebView window). ScrollView 
            handles transformation, clipping, and dirty rect management.
            
            I've filed a bunch of bugs on remaining frames work. Most notably, closing a page with
            a frame in it causes a crash because WebCore depends on WebKit to manage frame lifetime.
            I'm going to fix that by integrating frame ownership into the DOM.
            
2006-09-21  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by Anders.
        
        <rdar://4516072>
        <rdar://4601320>
        
        Implemented JavaScript alert/confirm/prompt inside app.
        This is done via IWebUIDelegate.

        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::userAgent):
        (WebCore::FrameWin::runJavaScriptAlert):
        (WebCore::FrameWin::runJavaScriptConfirm):
        (WebCore::FrameWin::runJavaScriptPrompt):
        * bridge/win/FrameWin.h:
        * platform/win/TemporaryLinkStubs.cpp:
        (FrameWin::registerCommandForRedo):

2006-09-21  Sean Gies  <seangies@apple.com>

        Reviewed by NOBODY (OOPS!).

        Unfork GraphicsContextCG.cpp.

        * WebCore.vcproj/WebCore.vcproj: Unfork GraphicsContextCG.cpp and add GraphicsContextWin.cpp
        * platform/win/GraphicsContextWin.cpp: Added.

2006-09-21  Luke Wallis  <wallis@apple.com>

        Rubber stamped by Steve.

        Added (commented out for now) defines for building on PLATFORM(CG).

        * config.h:

2006-09-21  Luke Wallis <wallis@apple.com>

        Reviewed by Adam Roben.

        Fix build. Added #if PLATFORM(CG) around variable defined only for CG.

        * platform/win/FontDataWin.cpp:
        (WebCore::FontData::platformInit):

2006-09-21  Sean Gies  <seangies@apple.com>

        Reviewed by Adam Roben.

        Draw form controls when rendering with CG.

        * platform/cg/GraphicsContextCG.cpp:
        (WebCore::CGContextWithHDC): New function to create CGContext given an HDC.
        (WebCore::GraphicsContext::GraphicsContext): New constructor that takes an HDC.
        (WebCore::GraphicsContext::getWindowsContext): Return underlying HDC to client.
        (WebCore::GraphicsContext::releaseWindowsContext): Restore underlying HDC after client mucked with it.
        * platform/cg/GraphicsContextPlatformPrivate.h: Add field to hold HDC.
        * rendering/RenderThemeWin.cpp: Implement prepareForDrawing and doneDrawing for CG.

2006-09-21  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Tim O.

        Support getting the plugin element as an NPObject.
        
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::getValue):
        (WebCore::PluginViewWin::PluginViewWin):
        * plugins/win/PluginViewWin.h:

2006-09-21  Sean Gies  <seangies@apple.com>

        Reviewed by Adam Roben.

        Forked GraphicsContextCG.cpp and GraphicsContextPlatformPrivate.h from open source #16504.

        * platform/cg/GraphicsContextCG.cpp: Added.
        * platform/cg/GraphicsContextPlatformPrivate.h: Added.

2006-09-21  Sean Gies  <seangies@apple.com>

        Reviewed by Adam Roben.

        Support synthetic bold and/or oblique with CG.

        * platform/win/FontCacheWin.cpp: Pass new arguments to updated FontPlatformData constructor.
        * platform/win/FontDataWin.cpp:
        (WebCore::FontData::platformInit): Choose synthetic bold offset.
        (WebCore::FontData::platformWidthForGlyph): Take synthetic bold offset into account.
        * platform/win/FontPlatformData.h: Add fields for synthetic styles.
        * platform/win/FontPlatformDataWin.cpp: Ask HFONT if it supports bold or italics.
        * platform/win/FontWin.cpp:
        (WebCore::Font::drawGlyphs): Restore code for implementing synthetic stlyes.

2006-09-21  Brady Eidson  <beidson@apple.com>

        Reviewed by Anders

        Fixed one definite bug and did alot of cleanup to make it resemble the unforked version of the file
        in preparation for merging it back out

        * platform/win/ResourceLoaderWin.cpp:
        (WebCore::ResourceLoaderWndProc):
        (WebCore::transferJobStatusCallback): Fixed a bug here!  :)
        (WebCore::ResourceLoader::start):
        (WebCore::ResourceLoader::fileLoadTimer):
        (WebCore::ResourceLoader::cancel):

2006-09-21  2006-09-21  Dave Hyatt <hyatt@apple.com>

        Implement mouse wheel scrolling on Win32.  Also forked ScrollViewWin.cpp and fixed some bugs in it.

        * WebCore.vcproj/WebCore.vcproj:
        * platform/win/ScrollViewWin.cpp: Added.
        (WebCore::ScrollView::ScrollViewPrivate::ScrollViewPrivate):
        (WebCore::ScrollView::ScrollView):
        (WebCore::ScrollView::~ScrollView):
        (WebCore::ScrollView::updateContents):
        (WebCore::ScrollView::visibleWidth):
        (WebCore::ScrollView::visibleHeight):
        (WebCore::ScrollView::visibleContentRect):
        (WebCore::ScrollView::setContentsPos):
        (WebCore::ScrollView::resizeContents):
        (WebCore::ScrollView::contentsX):
        (WebCore::ScrollView::contentsY):
        (WebCore::ScrollView::contentsWidth):
        (WebCore::ScrollView::contentsHeight):
        (WebCore::ScrollView::viewportToContents):
        (WebCore::ScrollView::contentsToViewport):
        (WebCore::ScrollView::scrollOffset):
        (WebCore::ScrollView::maximumScroll):
        (WebCore::ScrollView::scrollBy):
        (WebCore::ScrollView::hScrollBarMode):
        (WebCore::ScrollView::vScrollBarMode):
        (WebCore::ScrollView::suppressScrollBars):
        (WebCore::ScrollView::setHScrollBarMode):
        (WebCore::ScrollView::setVScrollBarMode):
        (WebCore::ScrollView::setScrollBarsMode):
        (WebCore::ScrollView::setStaticBackground):
        (WebCore::ScrollView::updateScrollInfo):
        (WebCore::ScrollView::updateScrollBars):
        (WebCore::ScrollView::wheelEvent):
        * platform/win/WheelEventWin.cpp: Added.
        (WebCore::positionForEvent):
        (WebCore::globalPositionForEvent):
        (WebCore::PlatformWheelEvent::PlatformWheelEvent):

2006-09-20  Sean Gies  <seangies@apple.com>

        Reviewed by Adam Roben.

        Added platform/cg/ColorCG.cpp

        * WebCore.vcproj/WebCore.vcproj: Add ColorCG.cpp
        * platform/cg/ColorCG.cpp: Added.

2006-09-20  Sean Gies  <seangies@apple.com>

        Reviewed by Adam Roben.

        Fixed ugly text spacing issues with CG for Windows.

        * platform/win/FontDataWin.cpp: Reimplement platformWidthForGlyph using CG APIs.

2006-09-19  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Dave Hyatt.
        
        <rdar://problem/4734743> Crash accessing YouTube.
        
        * config.h:
        Enable some more of the JSC bindings code on Windows.
        
2006-09-18  Brady Eidson  <beidson@apple.com>

        YABF, and merged a change from open source ResourceLoaderWin.cpp

        * bridge/win/FrameWin.h:
        * platform/win/ResourceLoaderWin.cpp:
        (WebCore::ResourceLoader::fileLoadTimer):
        * platform/win/TemporaryLinkStubs.cpp:
        (FrameWin::isLoadTypeReload):

2006-09-18  Sean Gies  <seangies@apple.com>

        Reviewed by Adam Roben.

        Support bold & italics.

        * platform/win/FontPlatformDataWin.cpp: Use GetOutlineTextMetrics instead of GetTextFace to
            query HFONT name.

2006-09-18  Sean Gies  <seangies@apple.com>

        Reviewed by Adam Roben.

        Changes to bring up CoreGraphics on Windows.

        * WebCore.vcproj/WebCore.vcproj: Search platform/cg for headers.  Compile platform/cg/*.cpp.
             Add AffineTransform.cpp to build.
        * platform/win/FontDataWin.cpp: Include CG before using it.
        * platform/win/FontPlatformDataWin.cpp: Fixed typo.
        * platform/win/ImageWin.cpp: Include CG and winsock2.  Implement CG version of Image::getHBITMAP.
             In Cairo version of Image::getHBITMAP, use correct bitmapInfo field and return true for success.
             Fixed image loading bug.

2006-09-18  Brady Eidson  <beidson@apple.com>

        Rubberstamp by Adam

        Build fix

        * bridge/win/FrameWin.h:
        * platform/win/TemporaryLinkStubs.cpp:
        (FrameWin::originalRequestURL):

2006-09-18  Sean Gies  <seangies@apple.com>

        Reviewed by Adam Roben.

        Forked FontCacheWin.cpp from OpenSource tree r16421.

        * WebCore.vcproj/WebCore.vcproj: Point to Internal file.
        * platform/win/FontCacheWin.cpp: Added.

2006-09-15  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Steve.

        * WebCore.vcproj/WebCore.vcproj:
        Add JavaScriptCore/ to include path.

2006-09-15  Adam Roben  <aroben@apple.com>

        Reviewed by sfalken.

        Implement historyContains() on Windows (rdar://4733770)

        * WebCore.vcproj/WebCore.vcproj: Add
        platform\win\WebCoreHistory.{cpp,h} and bridge\win\HistoryWin.cpp to
        project.
        * bridge/win/HistoryWin.cpp: Added.
        (WebCore::historyContains):
        * platform/win/TemporaryLinkStubs.cpp: Remove stub for
        WebCore::historyContains()
        * platform/win/WebCoreHistory.cpp: Added.
        (WebCore::WebCoreHistory::setHistoryProvider):
        (WebCore::WebCoreHistory::historyProvider):
        * platform/win/WebCoreHistory.h: Added.

2006-09-14  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by Lou Amadio.

        iBench fix - fix WinInet form post code to not reference a stale pointer.
        (found by Application Verifier)

        * platform/win/ResourceLoaderWin.cpp:
        (WebCore::ResourceLoaderWndProc):

2006-09-14  Adam Roben  <aroben@apple.com>

        Reviewed by sfalken.

        A little #include cleanup

        * WebCore.vcproj/WebCore.vcproj: Add loader/icon to
        AdditionalIncludeDirectories
        * platform/win/TemporaryLinkStubs.cpp: Remove "loader/icon" from
        #include of IconLoader.h

2006-09-14  Brady Eidson  <beidson@apple.com>

        Build Fix

        * WebCore.vcproj/WebCore.vcproj:
        * platform/win/TemporaryLinkStubs.cpp:
        (IconLoader::receivedResponse):
        (IconLoader::notifyIconChanged):

2006-09-13  Steve Falkenburg  <sfalken@apple.com>

        Fixes for submission of WebCore.  Doesn't affect build.

        * WebCore.vcproj/WebCore.vcproj:
        * WebCore.vcproj/merge-opensource.sh:

2006-09-12  Steve Falkenburg  <sfalken@apple.com>

        Rubber-stamped by Ada.

        Get Boomer ready for B&I submission.
       
        Projects can now all build independent of one another
        without groping for headers or source across trees.

        * WebCore.vcproj/WebCore.sln: Fix standalone sln for use by B&I.
        * WebCore.vcproj/WebCore.vcproj: Update to new obj layout.
        * WebCore.vcproj/build-generated-files.sh: Build derived sources into obj, update to new obj layout.
        * WebCore.vcproj/dstroot-to-sdk.cmd: Copy built bits back to WebKitSDKDir for dependent builds.

2006-09-13  Adam Roben  <aroben@apple.com>

        Build fix

        * WebCore.vcproj/WebCore.vcproj: Rename KHTML_XSLT to XSLT_SUPPORT,
        remove KHTML_NO_XBL
        * config.h: Ditto.

2006-09-13  Adam Roben  <aroben@apple.com>

        Reviewed by beidson.

        Initial implementation of Icon, FileChooser on Windows.

        * WebCore.vcproj/WebCore.vcproj: Added FileChooserWin.cpp, IconWin.cpp
        * platform/win/FileChooserWin.cpp: Added.
        (WebCore::FileChooser::FileChooser):
        (WebCore::FileChooser::openFileChooser):
        (WebCore::FileChooser::basenameForWidth):
        (WebCore::FileChooser::uploadControlDetaching):
        (WebCore::FileChooser::chooseFile):
        * platform/win/IconWin.cpp: Added.
        (WebCore::Icon::Icon):
        (WebCore::Icon::~Icon):
        (WebCore::Icon::newIconForFile):
        (WebCore::Icon::paint):
        * platform/win/TemporaryLinkStubs.cpp: Removed FileChooser, Icon stub
        functions

2006-09-13  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Tim O.

        Implement postURL and postURLNotify.

        * plugins/win/PluginStreamWin.cpp:
        (WebCore::PluginStreamWin::~PluginStreamWin):
        (WebCore::PluginStreamWin::start):
        (WebCore::PluginStreamWin::startStream):
        (WebCore::PluginStreamWin::cancelAndDestroyStream):
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::start):
        (WebCore::PluginViewWin::loadURL):
        (WebCore::PluginViewWin::getURLNotify):
        (WebCore::PluginViewWin::getURL):
        (WebCore::startsWithBlankLine):
        (WebCore::locationAfterFirstBlankLine):
        (WebCore::findEOL):
        (WebCore::capitalizeRFC822HeaderFieldName):
        (WebCore::parseRFC822HeaderFields):
        (WebCore::PluginViewWin::handlePost):
        (WebCore::PluginViewWin::postURLNotify):
        (WebCore::PluginViewWin::postURL):
        * plugins/win/PluginViewWin.h:

2006-09-13  Lou Amadio  <lamadio@apple.com>

        Reviewed by sfalken

        - Fixed retail build by adding the SDK entry for SQLite

        * WebCore.vcproj/WebCore.vcproj:

2006-09-13  Adam Roben  <aroben@apple.com>

        Build fix

        * WebCore.vcproj/build-generated-files.sh: Export SOURCE_ROOT which is
        now used by CodeGenerator.pm

2006-09-12  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Tim O.

        Add scripting support for plugins.
        
        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::FrameWin):
        (WebCore::FrameWin::addPluginRootObject):
        (WebCore::FrameWin::cleanupPluginObjects):
        (WebCore::FrameWin::bindingRootObject):
        (WebCore::FrameWin::windowScriptNPObject):
        * bridge/win/FrameWin.h:
        * plugins/win/PluginPackageWin.cpp:
        (WebCore::PluginPackageWin::load):
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::getValue):
        * plugins/win/npapi.cpp:
        (NPN_RequestRead):
        (NPN_InvalidateRect):
        (NPN_InvalidateRegion):
        (NPN_ForceRedraw):

2006-09-12  Adam Roben  <aroben@apple.com>

        Reviewed many times by darin, hyatt.

        Add stubs for new engine-based file upload control implementation and
        Icon class.

        * WebCore.vcproj/WebCore.vcproj: Add new engine-based files, remove old
        widget-based files.
        * platform/win/TemporaryLinkStubs.cpp: Add stubs for FileChooser and
        Icon methods, and add two new LocalizedString methods.
        (WebCore::fileButtonChooseFileLabel):
        (WebCore::fileButtonNoFileSelectedLabel):
        (FileChooser::FileChooser):
        (FileChooser::~FileChooser):
        (FileChooser::openFileChooser):
        (FileChooser::basenameForWidth):
        (FileChooser::uploadControlDetaching):
        (Icon::~Icon):
        (Icon::paint):

2006-09-11  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Tim O.

        Add stream and URL handling to PluginViewWin. Include PluginStreamWin.cpp in the build.
        Also fix a number of bugs discovered when loading various plugins.
        
        * WebCore.vcproj/WebCore.vcproj:
        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginRequestWin::PluginRequestWin):
        (WebCore::PluginRequestWin::url):
        (WebCore::PluginRequestWin::target):
        (WebCore::PluginRequestWin::notifyData):
        (WebCore::PluginRequestWin::sendNotification):
        (WebCore::scriptStringIfJavaScriptURL):
        (WebCore::registerPluginView):
        (WebCore::PluginViewWndProc):
        (WebCore::PluginViewWin::updateSize):
        (WebCore::PluginViewWin::setFrameGeometry):
        (WebCore::PluginViewWin::start):
        (WebCore::PluginViewWin::stop):
        (WebCore::createUTF8String):
        (WebCore::PluginViewWin::performRequest):
        (WebCore::PluginViewWin::requestTimerFired):
        (WebCore::PluginViewWin::scheduleRequest):
        (WebCore::PluginViewWin::loadURL):
        (WebCore::makeURL):
        (WebCore::PluginViewWin::getURLNotify):
        (WebCore::PluginViewWin::getURL):
        (WebCore::PluginViewWin::newStream):
        (WebCore::PluginViewWin::write):
        (WebCore::PluginViewWin::destroyStream):
        (WebCore::PluginViewWin::userAgent):
        (WebCore::PluginViewWin::~PluginViewWin):
        (WebCore::PluginViewWin::PluginViewWin):
        * plugins/win/PluginViewWin.h:

2006-09-11  Anders Carlsson  <acarlsson@apple.com>

        * WebCore.vcproj/WebCore.vcproj:
        Fix build.
        
2006-09-11  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Tim O and Maciej.

        Add plugin stream object.
        
        * plugins/win/PluginStreamWin.cpp: Added.
        (WebCore::PluginStreamWin::PluginStreamWin):
        (WebCore::PluginStreamWin::~PluginStreamWin):
        (WebCore::PluginStreamWin::setRequestHeaders):
        (WebCore::PluginStreamWin::setPostData):
        (WebCore::PluginStreamWin::start):
        (WebCore::PluginStreamWin::stop):
        (WebCore::PluginStreamWin::startStream):
        (WebCore::PluginStreamWin::cancelAndDestroyStream):
        (WebCore::PluginStreamWin::destroyStream):
        (WebCore::PluginStreamWin::delayDeliveryTimerFired):
        (WebCore::PluginStreamWin::deliverData):
        (WebCore::PluginStreamWin::receivedResponse):
        (WebCore::PluginStreamWin::receivedData):
        (WebCore::PluginStreamWin::receivedAllData):
        * plugins/win/PluginStreamWin.h: Added.

2006-09-10  Brady Eidson  <beidson@apple.com>

        Reviewed by Steven Falkenburg

        Added IconDatabase related code and forked ImageWin for its HBITMAP blit

        * WebCore.vcproj/WebCore.vcproj: Added in all WebCore::IconDatabase stuffs
        * platform/win/ImageWin.cpp: Added. (forked from OpenSource)
        (WebCore::Image::initPlatformData):
        (WebCore::Image::invalidatePlatformData):
        (WebCore::Image::loadPlatformResource):
        (WebCore::Image::supportsType):
        (WebCore::Image::getHBITMAP): Added - blit the image to an HBITMAP 
        
2006-09-10  David Hyatt  <hyatt@apple.com>

        Remove the addIntrinsicMargins code from the theme.  I did this
        in the open source version but forgot to do it in the internal
        version.

        * rendering/RenderThemeWin.cpp:
        (WebCore::RenderThemeWin::adjustButtonStyle):
        (WebCore::RenderThemeWin::adjustTextFieldStyle):
        (WebCore::RenderThemeWin::adjustTextAreaStyle):
        (WebCore::RenderThemeWin::adjustMenuListStyle):

2006-09-10  Brady Eidson  <beidson@apple.com>

        Reviewed by YABF, and Adam's suggestive rubberstamp before he hopped offline

        Build fix + FIXME/Radar to reflect an OpenSource change to the Font.h header

        * platform/win/FontWin.cpp:
        (WebCore::Font::drawGlyphs): Added the parameter and a FIXME 

2006-09-10  Steve Falkenburg  <sfalken@apple.com>

        Rubber-stamp by aroben.
        
        Pick up SDK from $(WebKitSDKDir).

        * WebCore.vcproj/WebCore.vcproj:

2006-09-09  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by aroben.

        Boomer SDK migration.  Pull all external dependencies in from Boomer SDK.
        
        SDK should be installed into C:\AppleInternal
        (substitute your system drive letter for C - scripts don't hard-code the drive letter)
        
        Added missing CF files to fix CFNetwork build variant

        * WebCore.vcproj/WebCore.vcproj: Use include paths, libs, DLLs from %SystemDrive%\AppleInternal
        * WebCore.vcproj/build-generated-files.sh: Don't copy open source DLLs from WebKitLibraries

2006-09-09  Adam Roben  <aroben@apple.com>

        Reviewed by hyatt.

        Remove unnecessary calls to setAffectedBy{Active,Hover}Rules

        * rendering/RenderThemeWin.cpp:
        (WebCore::RenderThemeWin::adjustMenuListStyle): Remove unnecessary calls

2006-09-06  Brady Eidson  <beidson@apple.com>

        YABF (Yet another build fix)

        * platform/win/FontDataWin.cpp: Added missing header

2006-09-06  Brady Eidson  <beidson@apple.com>

        Reviewed by Steve's rubberstamp

        Three stubs were added this morning, however the methods were already implemented in
        Internal/OpenSourceWin/WebCoreWin/bridge/win/FrameWin.cpp

        * platform/win/TemporaryLinkStubs.cpp: Nuked some repeat symbols

2006-09-06  Adam Roben  <aroben@apple.com>

        Reviewed by Darin.

        Fixed various Windows build issues caused by previous checkins.

        * bridge/win/FrameWin.h: Added missing #include, updated Selection to SelectionController.
        * platform/win/FontWin.cpp: Reorganized #includes.
        (WebCore::Font::drawGlyphs): Used a const_cast hack to fix ultimately broken code.
        * platform/win/ResourceLoaderWin.cpp: Added missing #include of CString.h and removed double #include of config.h.
        (WebCore::ResourceLoaderWndProc): Removed use of String::ascii.
        (WebCore::ResourceLoader::start): Ditto.
        * platform/win/TemporaryLinkStubs.cpp: Added missing stubs.
        (FrameWin::markMisspellings):
        (FrameWin::shouldChangeSelection):
        (FrameWin::respondToChangedSelection):
        (FrameWin::respondToChangedContents):
        (FrameWin::handledOnloadEvents):
        (FrameWin::createPlugin):
        (FrameWin::objectContentType):
        * rendering/RenderPopupMenuWin.cpp: Added missing #include.

2006-09-05  Darin Adler  <darin@apple.com>

        - build fix part of http://bugzilla.opendarwin.org/show_bug.cgi?id=10728
          text encodings should work without a numeric ID

        * WebCore.vcproj/WebCore.vcproj: Update for new headers.

2006-09-01  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by adachan.

        Process redirects received in networking layer through to application.
        With this change, the address bar url edit field shows the proper
        redirected URL.

        * platform/win/ResourceLoaderWin.cpp:
        (WebCore::ResourceLoaderWndProc):
        (WebCore::transferJobStatusCallback):
        (WebCore::ResourceLoader::start):

2006-09-01  Ada Chan  <adachan@apple.com>

        Reviewed by lamadio.

        Fixed build break.

        * bridge/win/FrameWin.h:
        * platform/win/TemporaryLinkStubs.cpp:
        (FrameWin::respondToChangedContents):

2006-08-31  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Steve.

        Add our own internal config.h so we can make changes to it.
        
        * WebCore.vcproj/WebCore.vcproj:
        Add config.h to the file list, move the KXMLCORE_PLATFORM_CF to the new config.h file 
                       
        * config.h: Added.
        
        * platform/win/ResourceLoaderWin.cpp:
        Include config.h        

2006-08-31  Dave Hyatt <hyatt@apple.com>

        Add a platform scrollbar class for Windows.  It doesn't really work yet.

        * WebCore.vcproj/WebCore.vcproj:
        * platform/win/TemporaryLinkStubs.cpp:
        * platform/win/PlatformScrollBarWin.cpp

2006-08-31  Anders Carlsson  <acarlsson@apple.com>

        Fix the build.

        * WebCore.vcproj/WebCore.vcproj:

2006-08-30  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by Ada Chan.

        Forms Auto-complete checkpoint.
        Generic forms autocomplete drop-downs are now functional.
        Address book autocomplete (and credit card autocomplete) is not functional.
        
        To do:
        - username/password pairs autofill
        - address book autofill
        - single-click autofill
        - credit card autofill
        - keychain equivalent secure store for username/passwords and credit cards
          (we currently use DPAPI to encrypt the form values plist but will want to
           protect this more sensitive info using an additional user supplied password)

        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::submitForm): Pass form values to submit form delegate
        * bridge/win/FrameWin.h: Pass form values to submit form delegate

2006-08-29  David Hyatt  <hyatt@apple.com>

        Make project changes so that the forked Font files (and Cairo/JPG/PNG) are all used.

        * WebCore.vcproj/WebCore.vcproj:

2006-08-29  David Hyatt  <hyatt@apple.com>

        This patch lands all the font changes.  It does not patch the project file
        yet, since this was done on Mac.  Will switch to Win32 after landing this
        and then fix any glitches.

        * platform/cairo/cairo-all.c: Added.
        * platform/cairo/pixman-all.c: Added.
        * platform/image-decoders/jpeg/jpeg-part1.c: Added.
        * platform/image-decoders/jpeg/jpeg-part2.c: Added.
        * platform/image-decoders/jpeg/jpeg-part3.c: Added.
        * platform/image-decoders/png/png-part1.c: Added.
        * platform/image-decoders/png/png-part2.c: Added.
        * platform/win/FontDataWin.cpp:
        (WebCore::FontData::platformInit):
        (WebCore::FontData::platformDestroy):
        (WebCore::FontData::platformWidthForGlyph):
        * platform/win/FontPlatformData.h:
        (WebCore::FontPlatformData::FontPlatformData):
        (WebCore::FontPlatformData::cgFont):
        (WebCore::FontPlatformData::operator==):
        * platform/win/FontPlatformDataWin.cpp:
        (WebCore::m_size):
        * platform/win/FontWin.cpp:
        (WebCore::Font::drawGlyphs):

2006-08-29  David Hyatt  <hyatt@apple.com>

        Forking the font files in preparation for dropping in CG code.

        Reviewed by adam

        * WebCore.vcproj/WebCore.vcproj:
        * platform/win/FontDataWin.cpp: Added.
        (WebCore::FontData::platformInit):
        (WebCore::FontData::platformDestroy):
        (WebCore::FontData::smallCapsFontData):
        (WebCore::FontData::containsCharacters):
        (WebCore::FontData::determinePitch):
        (WebCore::FontData::platformWidthForGlyph):
        * platform/win/FontPlatformData.h: Added.
        (WebCore::FontPlatformData::FontPlatformData):
        (WebCore::FontPlatformData::hfont):
        (WebCore::FontPlatformData::fontFace):
        (WebCore::FontPlatformData::scaledFont):
        (WebCore::FontPlatformData::size):
        (WebCore::FontPlatformData::hash):
        (WebCore::FontPlatformData::operator==):
        * platform/win/FontPlatformDataWin.cpp: Added.
        (WebCore::m_size):
        (WebCore::FontPlatformData::~FontPlatformData):
        * platform/win/FontWin.cpp: Added.
        (WebCore::notImplemented):
        (WebCore::Font::drawGlyphs):
        (WebCore::Font::selectionRectForComplexText):
        (WebCore::Font::drawComplexText):
        (WebCore::Font::floatWidthForComplexText):
        (WebCore::Font::offsetForPositionForComplexText):

2006-08-28  Geoffrey Garen  <ggaren@apple.com>

        Reviewed by Maciej.

        Landed CFNetwork loader, off by default. To enable, define:
            KXMLCORE_PLATFORM_CF
            KXMLCORE_USE_CFNETWORK

        CFNetwork uses winsock2. If you do this, you need to make sure that winsock2.h
        is included before windows.h in any translation unit in which it's used.
        A lot of the jiggering in this patch is devoted to that.
        
        * WebCore.vcproj/WebCore.vcproj:
        * platform/win/ResourceLoaderWin.cpp: Removed reliance on PlatformData
        since it wasn't being used, and removing it made easy work of integrating
        CFNetwork in a Windows-independent way.
        (WebCore::ResourceLoaderWndProc):
        (WebCore::ResourceLoader::fileLoadTimer):
        (WebCore::ResourceLoader::cancel):
        * platform/win/TemporaryLinkStubs.cpp:
        (Path::contains):
        * platform/win/WidgetWin.cpp:
        * plugins/win/PluginDatabaseWin.cpp:
        * plugins/win/PluginPackageWin.h:
        * plugins/win/PluginViewWin.h:
        * plugins/win/npapi.cpp:
        * rendering/RenderPopupMenuWin.cpp:
        * rendering/RenderPopupMenuWin.h:
        * rendering/RenderThemeWin.cpp:

2006-08-28  Ada Chan  <adachan@apple.com>

        Reviewed by ggaren.

        Fixed build.

        * platform/win/TemporaryLinkStubs.cpp:
        (Path::contains):

2006-08-25  David Hyatt  <hyatt@apple.com>

        Land CG/Cairo refactoring (and add some winsock2.h).  (I do not really
        understand why the winsock2.h stuff would suddenly be needed.)

        * platform/win/ResourceLoaderWin.h:
        * platform/win/TemporaryLinkStubs.cpp:
        (GraphicsContext::setAlpha):
        (GraphicsContext::drawFocusRing):
        (GraphicsContext::drawLineForMisspelling):
        (GraphicsContext::setCompositeOperation):
        * plugins/win/PluginPackageWin.h:
        * plugins/win/PluginViewWin.h:
        * plugins/win/npapi.cpp:
        * rendering/RenderThemeWin.cpp:
        (WebCore::prepareForDrawing):
        (WebCore::doneDrawing):

2006-08-24  Geoffrey Garen  <ggaren@apple.com>

        Reviewed by Darin.

        Frame refactoring: changed FrameView clients so they no longer assume that
        FrameViews are Widgets that can tell you things about the platform, in 
        preparation for divorcing FrameViews from heavy-weight Widgets altogether.

        This patch makes Page, rather than Widget, responsible for holding the
        page's HWND. Refactoring aside, I think this makes more sense.

2006-08-24  Geoffrey Garen  <ggaren@apple.com>

        Reviewed by Hyatt.

        Branching PageWin.cpp from r15969.

        * WebCore.vcproj/WebCore.vcproj:
        * bridge/win/PageWin.cpp: Added.
        (WebCore::Page::Page):
        (WebCore::Page::windowRect):
        (WebCore::Page::setWindowRect):

2006-08-23  Adam Roben  <aroben@apple.com>

        Reviewed by Ada.

        Fixed placement of popups when document is scrolled.

        * rendering/RenderPopupMenuWin.cpp:
        (WebCore::RenderPopupMenuWin::setPositionAndSize):

2006-08-23  Steve Falkenburg  <sfalken@apple.com>

        Build fix (many of our include paths were wrong!)

        * WebCore.vcproj/WebCore.vcproj:

2006-08-23  Adam Roben  <aroben@apple.com>

        Reviewed by Darin, Lou, Adele.

        Initial implementation of <select> elements on Windows.

        * WebCore.vcproj/WebCore.vcproj:
            Added RenderPopupMenuWin.cpp
        * platform/win/TemporaryLinkStubs.cpp:
        (RenderPopupMenuWin::addGroupLabel):
        * rendering/RenderPopupMenuWin.cpp: Added.
        (WebCore::RenderPopupMenuWin::RenderPopupMenuWin):
        (WebCore::RenderPopupMenuWin::~RenderPopupMenuWin):
        (WebCore::RenderPopupMenuWin::clear):
        (WebCore::RenderPopupMenuWin::populate):
        (WebCore::RenderPopupMenuWin::showPopup):
        (WebCore::RenderPopupMenuWin::hidePopup):
        (WebCore::RenderPopupMenuWin::setPositionAndSize):
        (WebCore::RenderPopupMenuWin::addOption):
        (WebCore::RenderPopupMenuWin::down):
        (WebCore::RenderPopupMenuWin::up):
        (WebCore::registerPopup):
        (WebCore::PopupWndProc):
        * rendering/RenderPopupMenuWin.h:
            Added useful properties.
        (WebCore::RenderPopupMenuWin::popupHandle):
        (WebCore::RenderPopupMenuWin::containerHandle):
        (WebCore::RenderPopupMenuWin::wasClicked):
        (WebCore::RenderPopupMenuWin::setWasClicked):
        * rendering/RenderThemeWin.cpp:
        (WebCore::RenderThemeWin::RenderThemeWin):
        (WebCore::RenderThemeWin::openButtonTheme):
        (WebCore::RenderThemeWin::openTextFieldTheme):
        (WebCore::RenderThemeWin::openMenuListTheme):
        (WebCore::RenderThemeWin::close):
        (WebCore::RenderThemeWin::supportsFocus):
        (WebCore::RenderThemeWin::determineState):
        (WebCore::RenderThemeWin::getThemeData):
        (WebCore::RenderThemeWin::paintButton):
        (WebCore::RenderThemeWin::paintTextField):
            Refactored the above methods and added cases for
            MenulistAppearance where appropriate.
        (WebCore::RenderThemeWin::paintMenuList):
        (WebCore::RenderThemeWin::adjustMenuListStyle):
            Implemented the above methods.
        * rendering/RenderThemeWin.h:

2006-08-22  Geoffrey Garen  <ggaren@apple.com>

        My first Windows build fix.

        * WebCore.vcproj/WebCore.vcproj:
            - Link against version.lib, since the new plug-in stuff requires it
            - Sync the release and debug header search paths, so release
              finds the JS bindings.

2006-08-18  Anders Carlsson  <acarlsson@apple.com>

        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::write):
        (WebCore::PluginViewWin::destroyStream):
        Another attempt at fixing the build. Make these two functions into instance methods of PluginViewWin.

2006-08-18  Anders Carlsson  <acarlsson@apple.com>

        * plugins/win/PluginViewWin.cpp:
        (WebCore::write):
        (WebCore::destroyStream):
        * plugins/win/PluginViewWin.h:
        Fix build by removing unneeded parameters.

2006-08-18  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Adele.

        Have the NPN functions call into the plugin view. Implement some of the plugin view methods.

        * plugins/win/PluginViewWin.cpp:
        (WebCore::PluginViewWin::start):
        (WebCore::PluginViewWin::setCurrentPluginView):
        (WebCore::PluginViewWin::currentPluginView):
        (WebCore::PluginViewWin::getURLNotify):
        (WebCore::PluginViewWin::getURL):
        (WebCore::PluginViewWin::postURLNotify):
        (WebCore::PluginViewWin::postURL):
        (WebCore::PluginViewWin::newStream):
        (WebCore::write):
        (WebCore::destroyStream):
        (WebCore::PluginViewWin::userAgent):
        (WebCore::PluginViewWin::status):
        (WebCore::PluginViewWin::getValue):
        (WebCore::PluginViewWin::setValue):
        (WebCore::PluginViewWin::~PluginViewWin):
        (WebCore::PluginViewWin::PluginViewWin):
        * plugins/win/PluginViewWin.h:
        * plugins/win/npapi.cpp:
        (pluginViewForInstance):
        (NPN_ReloadPlugins):
        (NPN_GetURLNotify):
        (NPN_GetURL):
        (NPN_PostURLNotify):
        (NPN_PostURL):
        (NPN_NewStream):
        (NPN_Write):
        (NPN_DestroyStream):
        (NPN_UserAgent):
        (NPN_Status):
        (NPN_GetValue):
        (NPN_SetValue):

2006-08-17  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Steve and Maciej.

        Add initial implementation of plugin view.

        * WebCore.vcproj/WebCore.vcproj:
        Add files.
        
        * bridge/win/FrameWin.cpp:
        (WebCore::FrameWin::objectContentType):
        (WebCore::FrameWin::createPlugin):
        Implement these functions.
        
        * platform/win/TemporaryLinkStubs.cpp:
        Remove implemented functions.
        
        * platform/win/WidgetWin.cpp: Add this file from the open source repo
        (WebCore::Widget::~Widget):
        Call DestroyWindow on the hWnd.
        
        * plugins/win/PluginDatabaseWin.cpp:
        (WebCore::PluginDatabaseWin::createPluginView):
        New function which creates a plugin view.
        
        * plugins/win/PluginDatabaseWin.h:
        
        * plugins/win/PluginPackageWin.cpp:
        (WebCore::PluginPackageWin::load):
        Assign the browser functions. They are just stubs for now.
               
        * plugins/win/PluginViewWin.cpp: Added.
        (WebCore::registerPluginView):
        (WebCore::PluginViewWndProc):
        (WebCore::PluginViewWin::invokeSetWindow):
        (WebCore::PluginViewWin::start):
        (WebCore::PluginViewWin::stop):
        (WebCore::createUTF8String):
        (WebCore::createUTF8StringArray):
        (WebCore::freeStringArray):
        (WebCore::PluginViewWin::~PluginViewWin):
        (WebCore::PluginViewWin::PluginViewWin):
        * plugins/win/PluginViewWin.h: Added.
        (WebCore::PluginViewWin::plugin):
        (WebCore::PluginViewWin::instance):
        * plugins/win/npapi.cpp: Added.
        (NPN_MemAlloc):
        (NPN_MemFree):
        (NPN_MemFlush):
        (NPN_ReloadPlugins):
        (NPN_RequestRead):
        (NPN_GetURLNotify):
        (NPN_GetURL):
        (NPN_PostURLNotify):
        (NPN_PostURL):
        (NPN_NewStream):
        (NPN_Write):
        (NPN_DestroyStream):
        (NPN_UserAgent):
        (NPN_Status):
        (NPN_InvalidateRect):
        (NPN_InvalidateRegion):
        (NPN_ForceRedraw):
        (NPN_GetValue):
        (NPN_SetValue):
        (NPN_GetJavaEnv):
        (NPN_GetJavaPeer):

2006-08-17  Anders Carlsson  <acarlsson@apple.com>

        Reviewed by Maciej.

        Add initial implementation of plugin database.
        
        * WebCore.vcproj/WebCore.vcproj:
        Add new files.
        
        * platform/win/TemporaryLinkStubs.cpp:
        Get rid of the PlugInInfoStore stubs.

        * plugins/win/PlugInInfoStoreWin.cpp: Added.
        (WebCore::PlugInInfoStore::createPluginInfoForPluginAtIndex):
        (WebCore::PlugInInfoStore::pluginCount):
        (WebCore::PlugInInfoStore::supportsMIMEType):
        (WebCore::refreshPlugins):
        * plugins/win/PluginDatabaseWin.cpp: Added.
        (WebCore::PluginDatabaseWin::installedPlugins):
        (WebCore::PluginDatabaseWin::refresh):
        (WebCore::PluginDatabaseWin::plugins):
        (WebCore::PluginDatabaseWin::getPluginsInPaths):
        (WebCore::PluginDatabaseWin::defaultPluginPaths):
        (WebCore::PluginDatabaseWin::isMIMETypeRegistered):
        (WebCore::PluginDatabaseWin::pluginForMIMEType):
        (WebCore::PluginDatabaseWin::pluginForExtension):
        * plugins/win/PluginDatabaseWin.h: Added.
        (WebCore::PluginDatabaseWin::setPluginPaths):
        * plugins/win/PluginPackageWin.cpp: Added.
        (WebCore::PluginPackageWin::~PluginPackageWin):
        (WebCore::getVersionInfo):
        (WebCore::splitString):
        (WebCore::PluginPackageWin::PluginPackageWin):
        (WebCore::PluginPackageWin::fetchInfo):
        (WebCore::PluginPackageWin::load):
        (WebCore::PluginPackageWin::unload):
        (WebCore::PluginPackageWin::unloadWithoutShutdown):
        (WebCore::PluginPackageWin::createPackage):
        (WebCore::PluginPackageWin::hash):
        (WebCore::PluginPackageWin::equal):
        * plugins/win/PluginPackageWin.h: Added.
        (WebCore::PluginPackageWin::name):
        (WebCore::PluginPackageWin::description):
        (WebCore::PluginPackageWin::fileName):
        (WebCore::PluginPackageWin::mimeToDescriptions):
        (WebCore::PluginPackageWin::mimeToExtensions):
        (WebCore::PluginPackageWin::pluginFuncs):
        (WebCore::PluginPackageWinHash::hash):
        (WebCore::PluginPackageWinHash::equal):
        (WTF::):
        * plugins/win/npfunctions.h: Added.

2006-08-17  Adam Roben  <aroben@apple.com>

        Removing this unintentionally added file.

        * rendering/RenderPopupMenuWin.cpp: Removed.

2006-08-17  Adam Roben  <aroben@apple.com>

        Reviewed by Steve.

        Branching files from OpenSource tree r15924 to prepare for <select>
        element implementation.

        * WebCore.vcproj/WebCore.vcproj:
        * rendering/RenderPopupMenuWin.h: Added.
        (WebCore::RenderPopupMenuWin::RenderPopupMenuWin):
        * rendering/RenderThemeWin.cpp: Added.
        (WebCore::theme):
        (WebCore::m_textFieldTheme):
        (WebCore::RenderThemeWin::~RenderThemeWin):
        (WebCore::RenderThemeWin::close):
        (WebCore::RenderThemeWin::platformActiveSelectionBackgroundColor):
        (WebCore::RenderThemeWin::platformInactiveSelectionBackgroundColor):
        (WebCore::RenderThemeWin::platformActiveSelectionForegroundColor):
        (WebCore::RenderThemeWin::platformInactiveSelectionForegroundColor):
        (WebCore::RenderThemeWin::addIntrinsicMargins):
        (WebCore::RenderThemeWin::supportsFocus):
        (WebCore::RenderThemeWin::determineState):
        (WebCore::RenderThemeWin::getThemeData):
        (WebCore::RenderThemeWin::adjustButtonStyle):
        (WebCore::prepareForDrawing):
        (WebCore::doneDrawing):
        (WebCore::RenderThemeWin::paintButton):
        (WebCore::RenderThemeWin::setCheckboxSize):
        (WebCore::RenderThemeWin::setRadioSize):
        (WebCore::RenderThemeWin::adjustTextFieldStyle):
        (WebCore::RenderThemeWin::paintTextField):
        (WebCore::RenderThemeWin::adjustTextAreaStyle):
        (WebCore::RenderThemeWin::paintTextArea):
        (WebCore::RenderThemeWin::createPopupMenu):
        * rendering/RenderThemeWin.h: Added.
        (WebCore::ThemeData::m_state):
        (WebCore::RenderThemeWin::supportsHover):
        (WebCore::RenderThemeWin::paintCheckbox):
        (WebCore::RenderThemeWin::paintRadio):

2006-08-15  Steve Falkenburg  <sfalken@apple.com>

        Pull TemporaryLinkStubs.cpp into internal tree to fix the build.

        * WebCore.vcproj/WebCore.vcproj:
        * platform/win/TemporaryLinkStubs.cpp: Added.
        (notImplemented):
        (FrameView::updateBorder):
        (FrameView::isFrameView):
        (PopUpButton::focusPolicy):
        (PopUpButton::populate):
        (Widget::enableFlushDrawing):
        (Widget::isEnabled):
        (Widget::focusPolicy):
        (Widget::disableFlushDrawing):
        (Widget::lockDrawingFocus):
        (Widget::unlockDrawingFocus):
        (JavaAppletWidget::JavaAppletWidget):
        (TextField::selectAll):
        (TextField::addSearchResult):
        (TextField::selectionStart):
        (TextField::hasSelectedText):
        (TextField::selectedText):
        (TextField::setAutoSaveName):
        (TextField::checksDescendantsForFocus):
        (TextField::setSelection):
        (TextField::setMaxResults):
        (TextField::edited):
        (Slider::Slider):
        (Slider::sizeHint):
        (Slider::setValue):
        (Slider::setMaxValue):
        (Slider::setMinValue):
        (Slider::~Slider):
        (Slider::setFont):
        (Slider::value):
        (ListBox::setSelected):
        (ListBox::sizeForNumberOfLines):
        (ListBox::isSelected):
        (ListBox::appendItem):
        (ListBox::doneAppendingItems):
        (ListBox::setWritingDirection):
        (ListBox::setEnabled):
        (ListBox::clear):
        (ListBox::checksDescendantsForFocus):
        (FileButton::FileButton):
        (FileButton::click):
        (FileButton::sizeForCharacterWidth):
        (FileButton::focusPolicy):
        (FileButton::frameGeometry):
        (FileButton::setFilename):
        (FileButton::baselinePosition):
        (FileButton::setFrameGeometry):
        (FileButton::setDisabled):
        (Slider::focusPolicy):
        (ListBox::focusPolicy):
        (TextField::focusPolicy):
        (Cursor::Cursor):
        (PlatformMouseEvent::PlatformMouseEvent):
        (WebCore::searchableIndexIntroduction):
        (WebCore::findNextSentenceFromIndex):
        (WebCore::findSentenceBoundary):
        (WebCore::findNextWordFromIndex):
        (WebCore::ServeSynchronousRequest):
        (FrameWin::focusWindow):
        (FrameWin::unfocusWindow):
        (FrameWin::locationbarVisible):
        (FrameWin::issueRedoCommand):
        (FrameWin::getObjectInstanceForWidget):
        (FrameWin::getEmbedInstanceForWidget):
        (FrameWin::canRedo):
        (FrameWin::canUndo):
        (FrameWin::registerCommandForRedo):
        (FrameWin::runJavaScriptPrompt):
        (FrameWin::shouldInterruptJavaScript):
        (FrameWin::openURL):
        (FrameWin::print):
        (FrameWin::getAppletInstanceForWidget):
        (FrameWin::passMouseDownEventToWidget):
        (FrameWin::issueCutCommand):
        (FrameWin::issueCopyCommand):
        (FrameWin::passWheelEventToChildWidget):
        (FrameWin::issueUndoCommand):
        (FrameWin::mimeTypeForFileName):
        (FrameWin::issuePasteCommand):
        (FrameWin::scheduleClose):
        (FrameWin::markMisspellings):
        (FrameWin::menubarVisible):
        (FrameWin::personalbarVisible):
        (FrameWin::statusbarVisible):
        (FrameWin::toolbarVisible):
        (FrameWin::issueTransposeCommand):
        (FrameWin::canPaste):
        (FrameWin::objectContentType):
        (FrameWin::canGoBackOrForward):
        (FrameWin::issuePasteAndMatchStyleCommand):
        (FrameWin::createPlugin):
        (BrowserExtensionWin::canRunModal):
        (BrowserExtensionWin::createNewWindow):
        (BrowserExtensionWin::canRunModalNow):
        (BrowserExtensionWin::runModal):
        (BrowserExtensionWin::goBackOrForward):
        (BrowserExtensionWin::historyURL):
        (GraphicsContext::addRoundedRectClip):
        (GraphicsContext::addInnerRoundedRectClip):
        (WebCore::screenDepthPerComponent):
        (WebCore::screenIsMonochrome):
        (WebCore::moveCursor):
        (WebCore::historyContains):
        (WebCore::submitButtonDefaultLabel):
        (WebCore::inputElementAltText):
        (WebCore::resetButtonDefaultLabel):
        (WebCore::defaultLanguage):
        (WebCore::findWordBoundary):
        (PlugInInfoStore::createPluginInfoForPluginAtIndex):
        (PlugInInfoStore::pluginCount):
        (WebCore::PlugInInfoStore::supportsMIMEType):
        (WebCore::refreshPlugins):
        (WebCore::ResourceLoader::assembleResponseHeaders):
        (WebCore::ResourceLoader::retrieveCharset):
        (FrameWin::restoreDocumentState):
        (FrameWin::partClearedInBegin):
        (FrameWin::createEmptyDocument):
        (FrameWin::overrideMediaType):
        (FrameWin::handledOnloadEvents):
        (FrameWin::markedTextRange):
        (FrameWin::passSubframeEventToSubframe):
        (FrameWin::lastEventIsMouseUp):
        (FrameWin::addMessageToConsole):
        (FrameWin::shouldChangeSelection):
        (FrameWin::respondToChangedSelection):
        (FrameWin::createFrame):
        (FrameWin::saveDocumentState):
        (FrameWin::registerCommandForUndo):
        (FrameWin::clearUndoRedoOperations):
        (FrameWin::incomingReferrer):
        (FrameWin::markMisspellingsInAdjacentWords):
        (FrameWin::respondToChangedContents):
        (BrowserExtensionWin::BrowserExtensionWin):
        (BrowserExtensionWin::setTypedIconURL):
        (BrowserExtensionWin::setIconURL):
        (BrowserExtensionWin::getHistoryLength):
        (WebCore::CheckIfReloading):
        (WebCore::CheckCacheObjectStatus):
        (Widget::setEnabled):
        (Widget::paint):
        (Widget::setIsSelected):
        (ScrollView::addChild):
        (ScrollView::removeChild):
        (ScrollView::scrollPointRecursively):
        (ScrollView::inWindow):
        (GraphicsContext::setShadow):
        (GraphicsContext::clearShadow):
        (GraphicsContext::beginTransparencyLayer):
        (GraphicsContext::endTransparencyLayer):
        (GraphicsContext::clearRect):
        (GraphicsContext::strokeRect):
        (GraphicsContext::setLineWidth):
        (GraphicsContext::setLineCap):
        (GraphicsContext::setLineJoin):
        (GraphicsContext::setMiterLimit):
        (GraphicsContext::setAlpha):
        (GraphicsContext::setCompositeOperation):
        (GraphicsContext::clip):
        (GraphicsContext::translate):
        (GraphicsContext::rotate):
        (GraphicsContext::scale):
        (Path::Path):
        (Path::~Path):
        (Path::contains):
        (Path::translate):
        (Path::boundingRect):
        (Path::operator=):
        (Path::clear):
        (Path::moveTo):
        (Path::addLineTo):
        (Path::addQuadCurveTo):
        (Path::addBezierCurveTo):
        (Path::addArcTo):
        (Path::closeSubpath):
        (Path::addArc):
        (Path::addRect):
        (Path::addEllipse):
        (TextField::TextField):
        (TextField::~TextField):
        (TextField::setFont):
        (TextField::setAlignment):
        (TextField::setWritingDirection):
        (TextField::maxLength):
        (TextField::setMaxLength):
        (TextField::text):
        (TextField::setText):
        (TextField::cursorPosition):
        (TextField::setCursorPosition):
        (TextField::setEdited):
        (TextField::setReadOnly):
        (TextField::setPlaceholderString):
        (TextField::setColors):
        (TextField::sizeForCharacterWidth):
        (TextField::baselinePosition):
        (TextField::setLiveSearch):
        (PopUpButton::PopUpButton):
        (PopUpButton::~PopUpButton):
        (PopUpButton::setFont):
        (PopUpButton::baselinePosition):
        (PopUpButton::setWritingDirection):
        (PopUpButton::clear):
        (PopUpButton::appendItem):
        (PopUpButton::setCurrentItem):
        (PopUpButton::sizeHint):
        (PopUpButton::frameGeometry):
        (PopUpButton::setFrameGeometry):
        (PlatformScrollBar::PlatformScrollBar):
        (PlatformScrollBar::~PlatformScrollBar):
        (PlatformScrollBar::width):
        (PlatformScrollBar::height):
        (PlatformScrollBar::setEnabled):
        (PlatformScrollBar::paint):
        (PlatformScrollBar::setScrollBarValue):
        (PlatformScrollBar::setKnobProportion):
        (PlatformScrollBar::setRect):
        (ScrollBar::ScrollBar):
        (ScrollBar::setSteps):
        (ScrollBar::scroll):
        (ScrollBar::setValue):
        (ScrollBar::setKnobProportion):
        (ListBox::ListBox):
        (ListBox::~ListBox):
        (ListBox::setSelectionMode):
        (ListBox::setFont):
        (WebCore::focusRingColor):
        (WebCore::setFocusRingColorChangeFunction):
        (Frame::setNeedsReapplyStyles):
        (Image::drawTiled):
        (RenderPopupMenuWin::~RenderPopupMenuWin):
        (RenderPopupMenuWin::clear):
        (RenderPopupMenuWin::populate):
        (RenderPopupMenuWin::showPopup):
        (RenderPopupMenuWin::addSeparator):
        (RenderPopupMenuWin::addGroupLabel):
        (RenderPopupMenuWin::addOption):
        (RenderThemeWin::paintMenuList):
        (RenderThemeWin::adjustMenuListStyle):
        (RenderThemeWin::systemFont):

2006-08-15  Steve Falkenburg  <sfalken@apple.com>

        Fix the build with TOT.

        * WebCore.vcproj/WebCore.vcproj:

2006-08-15  Steve Falkenburg  <sfalken@apple.com>

        Get this building.

        * WebCore.vcproj/WebCore.sln:
        * WebCore.vcproj/WebCore.vcproj:
        * WebCore.vcproj/build-generated-files.sh:

2006-08-15  Steve Falkenburg  <sfalken@apple.com>

        Initial check-in.

        * ChangeLog: Added.
        * WebCore.vcproj/WebCore.sln: Added.
        * WebCore.vcproj/WebCore.vcproj: Added.
        * WebCore.vcproj/build-generated-files.sh: Added.
        * bridge/win/FrameWin.cpp: Added.
        (WebCore::FrameWin::FrameWin):
        (WebCore::FrameWin::~FrameWin):
        (WebCore::FrameWin::urlSelected):
        (WebCore::FrameWin::submitForm):
        (WebCore::FrameWin::userAgent):
        (WebCore::FrameWin::runJavaScriptAlert):
        (WebCore::FrameWin::runJavaScriptConfirm):
        (WebCore::FrameWin::keyPress):
        (WebCore::FrameWin::setTitle):
        (WebCore::FrameWin::setStatusBarText):
        (WebCore::FrameWin::textFieldDidBeginEditing):
        (WebCore::FrameWin::textFieldDidEndEditing):
        (WebCore::FrameWin::textDidChangeInTextField):
        (WebCore::FrameWin::doTextFieldCommandFromEvent):
        (WebCore::FrameWin::textWillBeDeletedInTextField):
        (WebCore::FrameWin::textDidChangeInTextArea):
        * bridge/win/FrameWin.h: Added.
        (WebCore::Win):
        * platform/win/ResourceLoaderWin.cpp: Added.
        (WebCore::addToOutstandingJobs):
        (WebCore::removeFromOutstandingJobs):
        (WebCore::lookupResourceLoader):
        (WebCore::ResourceLoaderWndProc):
        (WebCore::initializeOffScreenResourceLoaderWindow):
        (WebCore::ResourceLoaderInternal::~ResourceLoaderInternal):
        (WebCore::ResourceLoader::~ResourceLoader):
        (WebCore::transferJobStatusCallback):
        (WebCore::ResourceLoader::start):
        (WebCore::ResourceLoader::fileLoadTimer):
        (WebCore::ResourceLoader::cancel):
        * platform/win/ResourceLoaderWin.h: Added.
